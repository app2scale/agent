{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0218321522076925, "cur_kl_coeff": 0.20000000000000007, "cur_lr": 4.999999999999999e-05, "total_loss": 9.741078503926595, "policy_loss": -0.003887220906714598, "vf_loss": 9.744917170206707, "vf_explained_var": -6.945331891377767e-05, "kl": 0.00024363113028931608, "entropy": 1.945613157749176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128}, "sampler_results": {"episode_reward_max": 60.16935166666666, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 60.16935166666666, "episode_len_mean": 127.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666], "episode_lengths": [127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47572759481576776, "mean_inference_ms": 2.2107857924241285, "mean_action_processing_ms": 0.16625477717472958, "mean_env_wait_ms": 108872.39201435677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 60.16935166666666, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 60.16935166666666, "episode_len_mean": 127.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666], "episode_lengths": [127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47572759481576776, "mean_inference_ms": 2.2107857924241285, "mean_action_processing_ms": 0.16625477717472958, "mean_env_wait_ms": 108872.39201435677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128, "num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008893927754671635, "num_env_steps_trained_throughput_per_sec": 0.008893927754671635, "timesteps_total": 128, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 128, "timers": {"training_iteration_time_ms": 14391841.589, "sample_time_ms": 14391466.635, "load_time_ms": 0.38, "load_throughput": 336596.183, "learn_time_ms": 373.526, "learn_throughput": 342.681, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 128, "num_env_steps_trained": 128, "num_agent_steps_sampled": 128, "num_agent_steps_trained": 128}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "default", "date": "2023-10-31_20-41-29", "timestamp": 1698774089, "time_this_iter_s": 14391.842024803162, "time_total_s": 14391.842024803162, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 14391.842024803162, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 8.900438340151958, "ram_util_percent": 48.21953535943892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44653266966342925, "cur_kl_coeff": 0.10000000000000003, "cur_lr": 4.999999999999999e-05, "total_loss": 7.745894575119019, "policy_loss": -0.004849212026844422, "vf_loss": 7.750704383850097, "vf_explained_var": -1.2560685475667317e-05, "kl": 0.0003946056655877328, "entropy": 1.9439970135688782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256}, "sampler_results": {"episode_reward_max": 81.13914650793653, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 70.6542490873016, "episode_len_mean": 127.5, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653], "episode_lengths": [127, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4701621991999609, "mean_inference_ms": 2.208320465008583, "mean_action_processing_ms": 0.1780962285494146, "mean_env_wait_ms": 111565.13364282106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 81.13914650793653, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 70.6542490873016, "episode_len_mean": 127.5, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653], "episode_lengths": [127, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4701621991999609, "mean_inference_ms": 2.208320465008583, "mean_action_processing_ms": 0.1780962285494146, "mean_env_wait_ms": 111565.13364282106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256, "num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00826877133198126, "num_env_steps_trained_throughput_per_sec": 0.00826877133198126, "timesteps_total": 256, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 256, "timers": {"training_iteration_time_ms": 14935885.688, "sample_time_ms": 14935480.533, "load_time_ms": 0.403, "load_throughput": 317675.096, "learn_time_ms": 403.875, "learn_throughput": 316.93, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 256, "num_env_steps_trained": 256, "num_agent_steps_sampled": 256, "num_agent_steps_trained": 256}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "default", "date": "2023-11-01_00-59-29", "timestamp": 1698789569, "time_this_iter_s": 15479.930213928223, "time_total_s": 29871.772238731384, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 29871.772238731384, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 9.988271521079563, "ram_util_percent": 48.67192410451479}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7422611474990845, "cur_kl_coeff": 0.05000000000000002, "cur_lr": 4.999999999999999e-05, "total_loss": 9.62544396718343, "policy_loss": -0.003949976184715828, "vf_loss": 9.629372310638427, "vf_explained_var": -4.115899403889974e-05, "kl": 0.0004323746445455375, "entropy": 1.941191800435384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 384, "num_env_steps_trained": 384, "num_agent_steps_sampled": 384, "num_agent_steps_trained": 384}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 78.17071985449735, "episode_len_mean": 127.66666666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888], "episode_lengths": [127, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.466879593460928, "mean_inference_ms": 2.2125037411033226, "mean_action_processing_ms": 0.1792444858478979, "mean_env_wait_ms": 112737.52535100824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 78.17071985449735, "episode_len_mean": 127.66666666666667, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888], "episode_lengths": [127, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.466879593460928, "mean_inference_ms": 2.2125037411033226, "mean_action_processing_ms": 0.1792444858478979, "mean_env_wait_ms": 112737.52535100824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384, "num_agent_steps_trained": 384, "num_env_steps_sampled": 384, "num_env_steps_trained": 384, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008533345298003972, "num_env_steps_trained_throughput_per_sec": 0.008533345298003972, "timesteps_total": 384, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 384, "timers": {"training_iteration_time_ms": 14957250.1, "sample_time_ms": 14956858.182, "load_time_ms": 0.481, "load_throughput": 265997.149, "learn_time_ms": 390.606, "learn_throughput": 327.696, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 384, "num_env_steps_trained": 384, "num_agent_steps_sampled": 384, "num_agent_steps_trained": 384}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "default", "date": "2023-11-01_05-09-29", "timestamp": 1698804569, "time_this_iter_s": 14999.97951722145, "time_total_s": 44871.751755952835, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 44871.751755952835, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.83820271975326, "ram_util_percent": 48.84629188279826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6895115772883097, "cur_kl_coeff": 0.02500000000000001, "cur_lr": 4.999999999999999e-05, "total_loss": 9.771140925089519, "policy_loss": -0.004523306339979172, "vf_loss": 9.775654729207357, "vf_explained_var": -4.678964614868164e-06, "kl": 0.0003741852825442038, "entropy": 1.9391368587811788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 79.907730625, "episode_len_mean": 127.75, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792], "episode_lengths": [127, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4640682063921583, "mean_inference_ms": 2.2119997911393874, "mean_action_processing_ms": 0.17880273914626896, "mean_env_wait_ms": 112411.32208431419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 79.907730625, "episode_len_mean": 127.75, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792], "episode_lengths": [127, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4640682063921583, "mean_inference_ms": 2.2119997911393874, "mean_action_processing_ms": 0.17880273914626896, "mean_env_wait_ms": 112411.32208431419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009831362160383208, "num_env_steps_trained_throughput_per_sec": 0.009831362160383208, "timesteps_total": 512, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 14472827.323, "sample_time_ms": 14472429.842, "load_time_ms": 0.475, "load_throughput": 269547.339, "learn_time_ms": 396.23, "learn_throughput": 323.044, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "default", "date": "2023-11-01_08-46-28", "timestamp": 1698817588, "time_this_iter_s": 13019.559360027313, "time_total_s": 57891.31111598015, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 57891.31111598015, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 8.946260701017605, "ram_util_percent": 48.85831583481398}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2396089712778726, "cur_kl_coeff": 0.012500000000000004, "cur_lr": 4.999999999999999e-05, "total_loss": 9.642306772867839, "policy_loss": -0.004229681504269441, "vf_loss": 9.646532249450683, "vf_explained_var": 4.3352444966634115e-06, "kl": 0.0003287809809383665, "entropy": 1.938079595565796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 640, "num_env_steps_trained": 640, "num_agent_steps_sampled": 640, "num_agent_steps_trained": 640}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 77.94331502380952, "episode_len_mean": 127.8, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761], "episode_lengths": [127, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4652588772805843, "mean_inference_ms": 2.212148856377355, "mean_action_processing_ms": 0.17790540938240101, "mean_env_wait_ms": 111692.3255253395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 77.94331502380952, "episode_len_mean": 127.8, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761], "episode_lengths": [127, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4652588772805843, "mean_inference_ms": 2.212148856377355, "mean_action_processing_ms": 0.17790540938240101, "mean_env_wait_ms": 111692.3255253395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640, "num_agent_steps_trained": 640, "num_env_steps_sampled": 640, "num_env_steps_trained": 640, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.010197974996569117, "num_env_steps_trained_throughput_per_sec": 0.010197974996569117, "timesteps_total": 640, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 640, "timers": {"training_iteration_time_ms": 14088564.142, "sample_time_ms": 14088169.156, "load_time_ms": 0.486, "load_throughput": 263585.483, "learn_time_ms": 393.765, "learn_throughput": 325.067, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 640, "num_env_steps_trained": 640, "num_agent_steps_sampled": 640, "num_agent_steps_trained": 640}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "default", "date": "2023-11-01_12-15-40", "timestamp": 1698830140, "time_this_iter_s": 12551.511800765991, "time_total_s": 70442.82291674614, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70442.82291674614, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 8.789595085171738, "ram_util_percent": 49.03956436749512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6140615701675415, "cur_kl_coeff": 0.006250000000000002, "cur_lr": 4.999999999999999e-05, "total_loss": 9.758894793192546, "policy_loss": -0.0006584284827113151, "vf_loss": 9.759552574157714, "vf_explained_var": 1.0251998901367187e-06, "kl": 0.00013708733774061936, "entropy": 1.9364410797754923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 768, "num_env_steps_trained": 768, "num_agent_steps_sampled": 768, "num_agent_steps_trained": 768}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 79.08708669312169, "episode_len_mean": 127.83333333333333, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253], "episode_lengths": [127, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4653016487143205, "mean_inference_ms": 2.21200487116247, "mean_action_processing_ms": 0.17705244707818638, "mean_env_wait_ms": 111001.82582885503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 79.08708669312169, "episode_len_mean": 127.83333333333333, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253], "episode_lengths": [127, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4653016487143205, "mean_inference_ms": 2.21200487116247, "mean_action_processing_ms": 0.17705244707818638, "mean_env_wait_ms": 111001.82582885503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768, "num_agent_steps_trained": 768, "num_env_steps_sampled": 768, "num_env_steps_trained": 768, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009795012064596594, "num_env_steps_trained_throughput_per_sec": 0.009795012064596594, "timesteps_total": 768, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 768, "timers": {"training_iteration_time_ms": 13918449.393, "sample_time_ms": 13918041.047, "load_time_ms": 0.481, "load_throughput": 266172.986, "learn_time_ms": 407.16, "learn_throughput": 314.373, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 768, "num_env_steps_trained": 768, "num_agent_steps_sampled": 768, "num_agent_steps_trained": 768}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "default", "date": "2023-11-01_15-53-28", "timestamp": 1698843208, "time_this_iter_s": 13067.876093864441, "time_total_s": 83510.69901061058, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 83510.69901061058, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 9.676923076923076, "ram_util_percent": 49.31267567857526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8754514833291371, "cur_kl_coeff": 0.003125000000000001, "cur_lr": 4.999999999999999e-05, "total_loss": 9.7306640625, "policy_loss": -0.004275420277069012, "vf_loss": 9.734938621520996, "vf_explained_var": 0.0003705024719238281, "kl": 0.0003370580574179864, "entropy": 1.9397766629854838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 896, "num_env_steps_trained": 896, "num_agent_steps_sampled": 896, "num_agent_steps_trained": 896}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 78.87281785714286, "episode_len_mean": 127.85714285714286, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987], "episode_lengths": [127, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46485105809470617, "mean_inference_ms": 2.2119410062271383, "mean_action_processing_ms": 0.1761638007721924, "mean_env_wait_ms": 110703.74372928575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 78.87281785714286, "episode_len_mean": 127.85714285714286, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987], "episode_lengths": [127, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46485105809470617, "mean_inference_ms": 2.2119410062271383, "mean_action_processing_ms": 0.1761638007721924, "mean_env_wait_ms": 110703.74372928575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896, "num_agent_steps_trained": 896, "num_env_steps_sampled": 896, "num_env_steps_trained": 896, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008465032907788382, "num_env_steps_trained_throughput_per_sec": 0.008465032907788382, "timesteps_total": 896, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 896, "timers": {"training_iteration_time_ms": 14090246.337, "sample_time_ms": 14089841.967, "load_time_ms": 0.488, "load_throughput": 262144.0, "learn_time_ms": 403.202, "learn_throughput": 317.459, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 896, "num_env_steps_trained": 896, "num_agent_steps_sampled": 896, "num_agent_steps_trained": 896}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "default", "date": "2023-11-01_20-05-29", "timestamp": 1698858329, "time_this_iter_s": 15121.028436899185, "time_total_s": 98631.72744750977, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 98631.72744750977, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 9.701951603931022, "ram_util_percent": 49.34350083441498}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.010926838715871, "cur_kl_coeff": 0.0015625000000000005, "cur_lr": 4.999999999999999e-05, "total_loss": 9.537195523579916, "policy_loss": -0.0058989318398137884, "vf_loss": 9.54309377670288, "vf_explained_var": 0.0006223797798156738, "kl": 0.0004074800973588329, "entropy": 1.942270310719808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 78.78024836309524, "episode_len_mean": 127.875, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4646683888448542, "mean_inference_ms": 2.2128329046418145, "mean_action_processing_ms": 0.17551098497210846, "mean_env_wait_ms": 110453.4813310802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 78.78024836309524, "episode_len_mean": 127.875, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4646683888448542, "mean_inference_ms": 2.2128329046418145, "mean_action_processing_ms": 0.17551098497210846, "mean_env_wait_ms": 110453.4813310802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009311735489743119, "num_env_steps_trained_throughput_per_sec": 0.009311735489743119, "timesteps_total": 1024, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 14047227.405, "sample_time_ms": 14046831.71, "load_time_ms": 0.484, "load_throughput": 264240.636, "learn_time_ms": 394.546, "learn_throughput": 324.423, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "default", "date": "2023-11-01_23-54-35", "timestamp": 1698872075, "time_this_iter_s": 13746.09537410736, "time_total_s": 112377.82282161713, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 112377.82282161713, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 9.148041815400306, "ram_util_percent": 49.421891891891896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.208621533711751, "cur_kl_coeff": 0.0007812500000000003, "cur_lr": 4.999999999999999e-05, "total_loss": 9.468183771769207, "policy_loss": -0.0026021162358423073, "vf_loss": 9.470785935719809, "vf_explained_var": -0.00013306538263956706, "kl": 0.00017469234835516546, "entropy": 1.944445053736369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1152, "num_env_steps_trained": 1152, "num_agent_steps_sampled": 1152, "num_agent_steps_trained": 1152}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 79.7548313271605, "episode_len_mean": 127.88888888888889, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46429936028920665, "mean_inference_ms": 2.213786111249256, "mean_action_processing_ms": 0.17497507555578645, "mean_env_wait_ms": 110172.66128632447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 79.7548313271605, "episode_len_mean": 127.88888888888889, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46429936028920665, "mean_inference_ms": 2.213786111249256, "mean_action_processing_ms": 0.17497507555578645, "mean_env_wait_ms": 110172.66128632447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152, "num_agent_steps_trained": 1152, "num_env_steps_sampled": 1152, "num_env_steps_trained": 1152, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009658240973416884, "num_env_steps_trained_throughput_per_sec": 0.009658240973416884, "timesteps_total": 1152, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 1152, "timers": {"training_iteration_time_ms": 13958972.231, "sample_time_ms": 13958573.538, "load_time_ms": 0.486, "load_throughput": 263617.121, "learn_time_ms": 397.56, "learn_throughput": 321.964, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 1152, "num_env_steps_trained": 1152, "num_agent_steps_sampled": 1152, "num_agent_steps_trained": 1152}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "default", "date": "2023-11-02_03-35-28", "timestamp": 1698885328, "time_this_iter_s": 13252.931302309036, "time_total_s": 125630.75412392616, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 125630.75412392616, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.428782990426827, "ram_util_percent": 49.625339821230234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9707699596881867, "cur_kl_coeff": 0.00039062500000000013, "cur_lr": 4.999999999999999e-05, "total_loss": 9.560853195190429, "policy_loss": -0.000547795028736194, "vf_loss": 9.561401240030925, "vf_explained_var": -0.00011486609776814779, "kl": 2.6188768257876895e-05, "entropy": 1.9446501056353251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1280, "num_env_steps_trained": 1280, "num_agent_steps_sampled": 1280, "num_agent_steps_trained": 1280}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.54270219047619, "episode_len_mean": 127.9, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.463720050247675, "mean_inference_ms": 2.2148612313627565, "mean_action_processing_ms": 0.17448785640124936, "mean_env_wait_ms": 110087.17269436717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.54270219047619, "episode_len_mean": 127.9, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.463720050247675, "mean_inference_ms": 2.2148612313627565, "mean_action_processing_ms": 0.17448785640124936, "mean_env_wait_ms": 110087.17269436717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280, "num_agent_steps_trained": 1280, "num_env_steps_sampled": 1280, "num_env_steps_trained": 1280, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008142124768563313, "num_env_steps_trained_throughput_per_sec": 0.008142124768563313, "timesteps_total": 1280, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 1280, "timers": {"training_iteration_time_ms": 14135146.222, "sample_time_ms": 14134751.933, "load_time_ms": 0.485, "load_throughput": 264000.252, "learn_time_ms": 393.165, "learn_throughput": 325.563, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 1280, "num_env_steps_trained": 1280, "num_agent_steps_sampled": 1280, "num_agent_steps_trained": 1280}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "default", "date": "2023-11-02_07-57-29", "timestamp": 1698901049, "time_this_iter_s": 15720.712601423264, "time_total_s": 141351.46672534943, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 141351.46672534943, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 9.794952512596424, "ram_util_percent": 49.69805145583448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8792070349057516, "cur_kl_coeff": 0.00019531250000000007, "cur_lr": 4.999999999999999e-05, "total_loss": 9.666406377156575, "policy_loss": -0.004770590768506129, "vf_loss": 9.67117691040039, "vf_explained_var": -0.00028172334035237633, "kl": 0.0002639316966517905, "entropy": 1.9442303419113158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1408, "num_env_steps_trained": 1408, "num_agent_steps_sampled": 1408, "num_agent_steps_trained": 1408}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 79.19171575396825, "episode_len_mean": 127.9090909090909, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4630008616185393, "mean_inference_ms": 2.215190592778725, "mean_action_processing_ms": 0.1740088478029711, "mean_env_wait_ms": 109898.96008261012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 79.19171575396825, "episode_len_mean": 127.9090909090909, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4630008616185393, "mean_inference_ms": 2.215190592778725, "mean_action_processing_ms": 0.1740088478029711, "mean_env_wait_ms": 109898.96008261012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408, "num_agent_steps_trained": 1408, "num_env_steps_sampled": 1408, "num_env_steps_trained": 1408, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.010600790902433313, "num_env_steps_trained_throughput_per_sec": 0.010600790902433313, "timesteps_total": 1408, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 1408, "timers": {"training_iteration_time_ms": 13903419.136, "sample_time_ms": 13903028.524, "load_time_ms": 0.489, "load_throughput": 261964.922, "learn_time_ms": 389.533, "learn_throughput": 328.598, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 1408, "num_env_steps_trained": 1408, "num_agent_steps_sampled": 1408, "num_agent_steps_trained": 1408}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "default", "date": "2023-11-02_11-18-43", "timestamp": 1698913123, "time_this_iter_s": 12074.571178913116, "time_total_s": 153426.03790426254, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 153426.03790426254, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 9.151825834542816, "ram_util_percent": 49.812325108853415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8480495373408, "cur_kl_coeff": 9.765625000000003e-05, "cur_lr": 4.999999999999999e-05, "total_loss": 9.640775362650553, "policy_loss": -0.0017735502837846677, "vf_loss": 9.642549133300781, "vf_explained_var": -2.8455257415771483e-05, "kl": 0.0002774374739298461, "entropy": 1.9413122455279033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.18772505291007, "episode_len_mean": 127.91666666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4624458996537115, "mean_inference_ms": 2.2161884017049034, "mean_action_processing_ms": 0.17356603334187484, "mean_env_wait_ms": 109832.53232059036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.18772505291007, "episode_len_mean": 127.91666666666667, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4624458996537115, "mean_inference_ms": 2.2161884017049034, "mean_action_processing_ms": 0.17356603334187484, "mean_env_wait_ms": 109832.53232059036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00802715339182171, "num_env_steps_trained_throughput_per_sec": 0.00802715339182171, "timesteps_total": 1536, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 13950013.844, "sample_time_ms": 13949635.198, "load_time_ms": 0.488, "load_throughput": 262336.141, "learn_time_ms": 377.576, "learn_throughput": 339.005, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "default", "date": "2023-11-02_15-44-29", "timestamp": 1698929069, "time_this_iter_s": 15945.877492904663, "time_total_s": 169371.9153971672, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 169371.9153971672, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 10.275615438719887, "ram_util_percent": 50.24228503604712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6184852441151937, "cur_kl_coeff": 4.8828125000000016e-05, "cur_lr": 4.999999999999999e-05, "total_loss": 9.349011834462484, "policy_loss": -0.001779870440562566, "vf_loss": 9.350791772206625, "vf_explained_var": -7.89642333984375e-05, "kl": 0.00015266619660299816, "entropy": 1.939826202392578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1664, "num_env_steps_trained": 1664, "num_agent_steps_sampled": 1664, "num_agent_steps_trained": 1664}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.75283041514042, "episode_len_mean": 127.92307692307692, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46179290209324725, "mean_inference_ms": 2.217045968662242, "mean_action_processing_ms": 0.17313923138526985, "mean_env_wait_ms": 109866.84635775846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.75283041514042, "episode_len_mean": 127.92307692307692, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46179290209324725, "mean_inference_ms": 2.217045968662242, "mean_action_processing_ms": 0.17313923138526985, "mean_env_wait_ms": 109866.84635775846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664, "num_agent_steps_trained": 1664, "num_env_steps_sampled": 1664, "num_env_steps_trained": 1664, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008119233012934053, "num_env_steps_trained_throughput_per_sec": 0.008119233012934053, "timesteps_total": 1664, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 1664, "timers": {"training_iteration_time_ms": 14026519.539, "sample_time_ms": 14026090.347, "load_time_ms": 0.47, "load_throughput": 272219.304, "learn_time_ms": 428.15, "learn_throughput": 298.96, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 1664, "num_env_steps_trained": 1664, "num_agent_steps_sampled": 1664, "num_agent_steps_trained": 1664}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "default", "date": "2023-11-02_20-07-14", "timestamp": 1698944834, "time_this_iter_s": 15765.03632760048, "time_total_s": 185136.95172476768, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 185136.95172476768, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 9.116505847303126, "ram_util_percent": 50.47595713459914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6642134745915731, "cur_kl_coeff": 2.4414062500000008e-05, "cur_lr": 4.999999999999999e-05, "total_loss": 9.685337130228678, "policy_loss": -0.0016833687822024026, "vf_loss": 9.68702049255371, "vf_explained_var": -7.842381795247396e-05, "kl": 0.00019987975861113227, "entropy": 1.940061875184377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1792, "num_env_steps_trained": 1792, "num_agent_steps_sampled": 1792, "num_agent_steps_trained": 1792}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 81.51124001984127, "episode_len_mean": 127.92857142857143, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4611574430858613, "mean_inference_ms": 2.2178136302357347, "mean_action_processing_ms": 0.1727369052884948, "mean_env_wait_ms": 109980.95331665294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 81.51124001984127, "episode_len_mean": 127.92857142857143, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4611574430858613, "mean_inference_ms": 2.2178136302357347, "mean_action_processing_ms": 0.1727369052884948, "mean_env_wait_ms": 109980.95331665294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792, "num_agent_steps_trained": 1792, "num_env_steps_sampled": 1792, "num_env_steps_trained": 1792, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.0077510562847812135, "num_env_steps_trained_throughput_per_sec": 0.0077510562847812135, "timesteps_total": 1792, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 1792, "timers": {"training_iteration_time_ms": 14375951.464, "sample_time_ms": 14375533.356, "load_time_ms": 0.467, "load_throughput": 274361.668, "learn_time_ms": 417.082, "learn_throughput": 306.894, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 1792, "num_env_steps_trained": 1792, "num_agent_steps_sampled": 1792, "num_agent_steps_trained": 1792}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "default", "date": "2023-11-03_00-42-28", "timestamp": 1698961348, "time_this_iter_s": 16513.87865614891, "time_total_s": 201650.8303809166, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 201650.8303809166, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 9.404801120685997, "ram_util_percent": 50.435399244385955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6996028860410054, "cur_kl_coeff": 1.2207031250000004e-05, "cur_lr": 4.999999999999999e-05, "total_loss": 9.672320079803466, "policy_loss": -0.006017135952909787, "vf_loss": 9.678337287902831, "vf_explained_var": -3.471771876017253e-05, "kl": 0.0008690156960559155, "entropy": 1.935599676767985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 81.59500643386244, "episode_len_mean": 127.93333333333334, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46045455155374876, "mean_inference_ms": 2.2181510668425566, "mean_action_processing_ms": 0.17233508726148478, "mean_env_wait_ms": 110041.70844349351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 81.59500643386244, "episode_len_mean": 127.93333333333334, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46045455155374876, "mean_inference_ms": 2.2181510668425566, "mean_action_processing_ms": 0.17233508726148478, "mean_env_wait_ms": 110041.70844349351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920, "num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009653339182431454, "num_env_steps_trained_throughput_per_sec": 0.009653339182431454, "timesteps_total": 1920, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 1920, "timers": {"training_iteration_time_ms": 14446766.365, "sample_time_ms": 14446349.926, "load_time_ms": 0.475, "load_throughput": 269378.28, "learn_time_ms": 415.395, "learn_throughput": 308.14, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 1920, "num_env_steps_trained": 1920, "num_agent_steps_sampled": 1920, "num_agent_steps_trained": 1920}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "default", "date": "2023-11-03_04-23-28", "timestamp": 1698974608, "time_this_iter_s": 13259.660944700241, "time_total_s": 214910.49132561684, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 214910.49132561684, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 9.037176843774782, "ram_util_percent": 50.48692572032778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8129611174265543, "cur_kl_coeff": 6.103515625000002e-06, "cur_lr": 4.999999999999999e-05, "total_loss": 9.222720940907797, "policy_loss": -0.005263681927074989, "vf_loss": 9.227984937032064, "vf_explained_var": -0.00012381871541341147, "kl": 0.0007658453624875013, "entropy": 1.9278510133425395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 81.52258697916668, "episode_len_mean": 127.9375, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4597024481046715, "mean_inference_ms": 2.218390735405233, "mean_action_processing_ms": 0.17196851028823829, "mean_env_wait_ms": 110186.68888224565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 81.52258697916668, "episode_len_mean": 127.9375, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4597024481046715, "mean_inference_ms": 2.218390735405233, "mean_action_processing_ms": 0.17196851028823829, "mean_env_wait_ms": 110186.68888224565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.007356059575772092, "num_env_steps_trained_throughput_per_sec": 0.007356059575772092, "timesteps_total": 2048, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 14880040.832, "sample_time_ms": 14879635.397, "load_time_ms": 0.478, "load_throughput": 267899.657, "learn_time_ms": 404.387, "learn_throughput": 316.529, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "default", "date": "2023-11-03_09-13-29", "timestamp": 1698992009, "time_this_iter_s": 17400.620767354965, "time_total_s": 232311.1120929718, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 232311.1120929718, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 9.323802425365619, "ram_util_percent": 50.6928085089239}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8188043812910716, "cur_kl_coeff": 3.051757812500001e-06, "cur_lr": 4.999999999999999e-05, "total_loss": 9.667792256673177, "policy_loss": -0.00566535210236907, "vf_loss": 9.673457558949789, "vf_explained_var": -0.0002214670181274414, "kl": 0.0008499704873126272, "entropy": 1.9248396515846253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2176, "num_env_steps_trained": 2176, "num_agent_steps_sampled": 2176, "num_agent_steps_trained": 2176}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.7566877054155, "episode_len_mean": 127.94117647058823, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4589396965439749, "mean_inference_ms": 2.2184770778175924, "mean_action_processing_ms": 0.1716181163248582, "mean_env_wait_ms": 110287.9572657697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.7566877054155, "episode_len_mean": 127.94117647058823, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4589396965439749, "mean_inference_ms": 2.2184770778175924, "mean_action_processing_ms": 0.1716181163248582, "mean_env_wait_ms": 110287.9572657697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176, "num_agent_steps_trained": 2176, "num_env_steps_sampled": 2176, "num_env_steps_trained": 2176, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009524320765490143, "num_env_steps_trained_throughput_per_sec": 0.009524320765490143, "timesteps_total": 2176, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 2176, "timers": {"training_iteration_time_ms": 14711865.885, "sample_time_ms": 14711460.481, "load_time_ms": 0.474, "load_throughput": 270178.105, "learn_time_ms": 404.359, "learn_throughput": 316.55, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 2176, "num_env_steps_trained": 2176, "num_agent_steps_sampled": 2176, "num_agent_steps_trained": 2176}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "default", "date": "2023-11-03_12-57-28", "timestamp": 1699005448, "time_this_iter_s": 13439.279055833817, "time_total_s": 245750.39114880562, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 245750.39114880562, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 9.145269142499478, "ram_util_percent": 50.82199561861047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8866617023944855, "cur_kl_coeff": 1.5258789062500005e-06, "cur_lr": 4.999999999999999e-05, "total_loss": 9.659437878926594, "policy_loss": -0.005147479722897212, "vf_loss": 9.66458543141683, "vf_explained_var": -1.8938382466634115e-05, "kl": 0.0006110753823425815, "entropy": 1.9207403898239135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2304, "num_env_steps_trained": 2304, "num_agent_steps_sampled": 2304, "num_agent_steps_trained": 2304}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.1715915542328, "episode_len_mean": 127.94444444444444, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4581917550908311, "mean_inference_ms": 2.2184384361797598, "mean_action_processing_ms": 0.1712840629198704, "mean_env_wait_ms": 110317.9376095985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.1715915542328, "episode_len_mean": 127.94444444444444, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4581917550908311, "mean_inference_ms": 2.2184384361797598, "mean_action_processing_ms": 0.1712840629198704, "mean_env_wait_ms": 110317.9376095985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304, "num_agent_steps_trained": 2304, "num_env_steps_sampled": 2304, "num_env_steps_trained": 2304, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.01088247446437725, "num_env_steps_trained_throughput_per_sec": 0.01088247446437725, "timesteps_total": 2304, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 2304, "timers": {"training_iteration_time_ms": 14513459.476, "sample_time_ms": 14513027.711, "load_time_ms": 0.467, "load_throughput": 274305.596, "learn_time_ms": 430.724, "learn_throughput": 297.174, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 2304, "num_env_steps_trained": 2304, "num_agent_steps_sampled": 2304, "num_agent_steps_trained": 2304}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "default", "date": "2023-11-03_16-13-30", "timestamp": 1699017210, "time_this_iter_s": 11762.03124332428, "time_total_s": 257512.4223921299, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 257512.4223921299, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.587549913582453, "ram_util_percent": 55.644043149174564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8304394563039144, "cur_kl_coeff": 7.629394531250003e-07, "cur_lr": 4.999999999999999e-05, "total_loss": 9.643014812469483, "policy_loss": -0.0023708013507227105, "vf_loss": 9.645385392506917, "vf_explained_var": 3.8286050160725914e-05, "kl": 0.0002569386116192618, "entropy": 1.924456818898519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2432, "num_env_steps_trained": 2432, "num_agent_steps_sampled": 2432, "num_agent_steps_trained": 2432}, "sampler_results": {"episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.20124183375104, "episode_len_mean": 127.94736842105263, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574490813534349, "mean_inference_ms": 2.2184190949068174, "mean_action_processing_ms": 0.17096130871226004, "mean_env_wait_ms": 110370.19953492038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 93.20366138888888, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.20124183375104, "episode_len_mean": 127.94736842105263, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4574490813534349, "mean_inference_ms": 2.2184190949068174, "mean_action_processing_ms": 0.17096130871226004, "mean_env_wait_ms": 110370.19953492038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432, "num_agent_steps_trained": 2432, "num_env_steps_sampled": 2432, "num_env_steps_trained": 2432, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008205583919601033, "num_env_steps_trained_throughput_per_sec": 0.008205583919601033, "timesteps_total": 2432, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 2432, "timers": {"training_iteration_time_ms": 14748079.75, "sample_time_ms": 14747653.357, "load_time_ms": 0.455, "load_throughput": 281452.641, "learn_time_ms": 425.365, "learn_throughput": 300.918, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 2432, "num_env_steps_trained": 2432, "num_agent_steps_sampled": 2432, "num_agent_steps_trained": 2432}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "default", "date": "2023-11-03_20-33-29", "timestamp": 1699032809, "time_this_iter_s": 15599.13403582573, "time_total_s": 273111.5564279556, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 273111.5564279556, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.74693299779805, "ram_util_percent": 63.65976722239697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9227726836999257, "cur_kl_coeff": 3.8146972656250013e-07, "cur_lr": 4.999999999999999e-05, "total_loss": 9.579097175598145, "policy_loss": -0.003010799021770557, "vf_loss": 9.582108275095623, "vf_explained_var": 0.00018515189488728842, "kl": 0.0005743740258367325, "entropy": 1.9218803246815999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "sampler_results": {"episode_reward_max": 95.89547087301587, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.98595328571429, "episode_len_mean": 127.95, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567752260151773, "mean_inference_ms": 2.2183222224203965, "mean_action_processing_ms": 0.17064291500765513, "mean_env_wait_ms": 110455.53035675501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 95.89547087301587, "episode_reward_min": 60.16935166666666, "episode_reward_mean": 80.98595328571429, "episode_len_mean": 127.95, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4567752260151773, "mean_inference_ms": 2.2183222224203965, "mean_action_processing_ms": 0.17064291500765513, "mean_env_wait_ms": 110455.53035675501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.007887061664167666, "num_env_steps_trained_throughput_per_sec": 0.007887061664167666, "timesteps_total": 2560, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 14798919.643, "sample_time_ms": 14798497.894, "load_time_ms": 0.474, "load_throughput": 270028.625, "learn_time_ms": 420.693, "learn_throughput": 304.26, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "default", "date": "2023-11-04_01-03-58", "timestamp": 1699049038, "time_this_iter_s": 16229.11149263382, "time_total_s": 289340.66792058945, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 289340.66792058945, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 9.093343700056153, "ram_util_percent": 50.69286855859359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2600953578948975, "cur_kl_coeff": 1.9073486328125006e-07, "cur_lr": 4.999999999999999e-05, "total_loss": 9.1280730565389, "policy_loss": -0.00430818380167087, "vf_loss": 9.132381057739257, "vf_explained_var": 0.0011354645093282064, "kl": 0.0005701956207606903, "entropy": 1.9159757534662882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.72907386243386, "episode_len_mean": 127.95238095238095, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4561289915682365, "mean_inference_ms": 2.2180996558538553, "mean_action_processing_ms": 0.17033287622774923, "mean_env_wait_ms": 110492.11329085477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.72907386243386, "episode_len_mean": 127.95238095238095, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4561289915682365, "mean_inference_ms": 2.2180996558538553, "mean_action_processing_ms": 0.17033287622774923, "mean_env_wait_ms": 110492.11329085477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.01043115419558544, "num_env_steps_trained_throughput_per_sec": 0.01043115419558544, "timesteps_total": 2688, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 14818555.921, "sample_time_ms": 14818135.194, "load_time_ms": 0.495, "load_throughput": 258508.721, "learn_time_ms": 419.626, "learn_throughput": 305.033, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "default", "date": "2023-11-04_04-28-29", "timestamp": 1699061309, "time_this_iter_s": 12270.934001207352, "time_total_s": 301611.6019217968, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 301611.6019217968, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 8.571657906764168, "ram_util_percent": 50.7872600548446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4603877445062002, "cur_kl_coeff": 9.536743164062503e-08, "cur_lr": 4.999999999999999e-05, "total_loss": 9.374115180969238, "policy_loss": -0.005349463100234667, "vf_loss": 9.379464530944825, "vf_explained_var": -2.238750457763672e-05, "kl": 0.0006621565422695615, "entropy": 1.911063814163208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2816, "num_env_steps_trained": 2816, "num_agent_steps_sampled": 2816, "num_agent_steps_trained": 2816}, "sampler_results": {"episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.64480721139972, "episode_len_mean": 127.95454545454545, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4555157299031677, "mean_inference_ms": 2.217745570743939, "mean_action_processing_ms": 0.17002841631238164, "mean_env_wait_ms": 110502.64887043227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.64480721139972, "episode_len_mean": 127.95454545454545, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4555157299031677, "mean_inference_ms": 2.217745570743939, "mean_action_processing_ms": 0.17002841631238164, "mean_env_wait_ms": 110502.64887043227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816, "num_agent_steps_trained": 2816, "num_env_steps_sampled": 2816, "num_env_steps_trained": 2816, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009923629203226373, "num_env_steps_trained_throughput_per_sec": 0.009923629203226373, "timesteps_total": 2816, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 2816, "timers": {"training_iteration_time_ms": 14513818.916, "sample_time_ms": 14513387.627, "load_time_ms": 0.496, "load_throughput": 257962.191, "learn_time_ms": 430.197, "learn_throughput": 297.538, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 2816, "num_env_steps_trained": 2816, "num_agent_steps_sampled": 2816, "num_agent_steps_trained": 2816}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "default", "date": "2023-11-04_08-03-28", "timestamp": 1699074208, "time_this_iter_s": 12898.507395744324, "time_total_s": 314510.1093175411, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 314510.1093175411, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 8.726364130434783, "ram_util_percent": 50.890434782608686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9579869012037913, "cur_kl_coeff": 4.7683715820312516e-08, "cur_lr": 4.999999999999999e-05, "total_loss": 9.633944765726726, "policy_loss": -0.012801556661725045, "vf_loss": 9.646746635437012, "vf_explained_var": -3.724892934163411e-05, "kl": 0.002136864921825084, "entropy": 1.8958939870198568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 2944, "num_env_steps_trained": 2944, "num_agent_steps_sampled": 2944, "num_agent_steps_trained": 2944}, "sampler_results": {"episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 78.64127296238786, "episode_len_mean": 127.95652173913044, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4548969534387436, "mean_inference_ms": 2.2172048030698694, "mean_action_processing_ms": 0.16973455356596662, "mean_env_wait_ms": 110468.2769261347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 78.64127296238786, "episode_len_mean": 127.95652173913044, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4548969534387436, "mean_inference_ms": 2.2172048030698694, "mean_action_processing_ms": 0.16973455356596662, "mean_env_wait_ms": 110468.2769261347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944, "num_agent_steps_trained": 2944, "num_env_steps_sampled": 2944, "num_env_steps_trained": 2944, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.011418971452448176, "num_env_steps_trained_throughput_per_sec": 0.011418971452448176, "timesteps_total": 2944, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 2944, "timers": {"training_iteration_time_ms": 14058256.913, "sample_time_ms": 14057881.969, "load_time_ms": 0.499, "load_throughput": 256520.097, "learn_time_ms": 373.861, "learn_throughput": 342.373, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 2944, "num_env_steps_trained": 2944, "num_agent_steps_sampled": 2944, "num_agent_steps_trained": 2944}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "default", "date": "2023-11-04_11-10-17", "timestamp": 1699085417, "time_this_iter_s": 11209.416347026825, "time_total_s": 325719.52566456795, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 325719.52566456795, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 9.389662288930582, "ram_util_percent": 51.0479612257661}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6005349655946096, "cur_kl_coeff": 2.3841857910156258e-08, "cur_lr": 4.999999999999999e-05, "total_loss": 9.34074354171753, "policy_loss": -0.0007722973513106505, "vf_loss": 9.341515795389812, "vf_explained_var": 5.422631899515788e-05, "kl": 0.0006381316370000907, "entropy": 1.8722285072008769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 705.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "sampler_results": {"episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 78.48365387070106, "episode_len_mean": 127.95833333333333, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4543037168422408, "mean_inference_ms": 2.216657079535311, "mean_action_processing_ms": 0.16945686678603003, "mean_env_wait_ms": 110448.54174767881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 78.48365387070106, "episode_len_mean": 127.95833333333333, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4543037168422408, "mean_inference_ms": 2.216657079535311, "mean_action_processing_ms": 0.16945686678603003, "mean_env_wait_ms": 110448.54174767881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00845939952531446, "num_env_steps_trained_throughput_per_sec": 0.00845939952531446, "timesteps_total": 3072, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 13919978.847, "sample_time_ms": 13919573.692, "load_time_ms": 0.504, "load_throughput": 253839.675, "learn_time_ms": 404.057, "learn_throughput": 316.787, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "default", "date": "2023-11-04_15-22-29", "timestamp": 1699100549, "time_this_iter_s": 15131.098592996597, "time_total_s": 340850.62425756454, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 340850.62425756454, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 8.884826723498888, "ram_util_percent": 51.13567457375834}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2443713744481406, "cur_kl_coeff": 1.1920928955078129e-08, "cur_lr": 4.999999999999999e-05, "total_loss": 9.248639392852784, "policy_loss": -0.002694394625723362, "vf_loss": 9.251333808898925, "vf_explained_var": -9.64800516764323e-06, "kl": 0.0004146962576366301, "entropy": 1.8655733068784077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 735.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "sampler_results": {"episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 78.38860702698413, "episode_len_mean": 127.96, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4537319351239813, "mean_inference_ms": 2.2160845545745356, "mean_action_processing_ms": 0.1691924774045183, "mean_env_wait_ms": 110417.0205250467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 78.38860702698413, "episode_len_mean": 127.96, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4537319351239813, "mean_inference_ms": 2.2160845545745356, "mean_action_processing_ms": 0.1691924774045183, "mean_env_wait_ms": 110417.0205250467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009741174600029393, "num_env_steps_trained_throughput_per_sec": 0.009741174600029393, "timesteps_total": 3200, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 3200, "timers": {"training_iteration_time_ms": 13908022.715, "sample_time_ms": 13907621.552, "load_time_ms": 0.504, "load_throughput": 253899.698, "learn_time_ms": 400.064, "learn_throughput": 319.949, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "default", "date": "2023-11-04_19-01-29", "timestamp": 1699113689, "time_this_iter_s": 13140.0996260643, "time_total_s": 353990.72388362885, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 353990.72388362885, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 9.324215749039693, "ram_util_percent": 51.2131562099872}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48633234202861786, "cur_kl_coeff": 5.9604644775390645e-09, "cur_lr": 4.999999999999999e-05, "total_loss": 9.635274505615234, "policy_loss": -0.0037957648746669292, "vf_loss": 9.639070224761962, "vf_explained_var": -4.482269287109375e-06, "kl": 0.0007455807169208129, "entropy": 1.853516666094462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3328, "num_env_steps_trained": 3328, "num_agent_steps_sampled": 3328, "num_agent_steps_trained": 3328}, "sampler_results": {"episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 78.58151717796093, "episode_len_mean": 127.96153846153847, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4531663371469842, "mean_inference_ms": 2.215457543762174, "mean_action_processing_ms": 0.1689349538597227, "mean_env_wait_ms": 110389.44896437289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 95.89547087301587, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 78.58151717796093, "episode_len_mean": 127.96153846153847, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4531663371469842, "mean_inference_ms": 2.215457543762174, "mean_action_processing_ms": 0.1689349538597227, "mean_env_wait_ms": 110389.44896437289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3328, "num_agent_steps_trained": 3328, "num_env_steps_sampled": 3328, "num_env_steps_trained": 3328, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00907788597185554, "num_env_steps_trained_throughput_per_sec": 0.00907788597185554, "timesteps_total": 3328, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 3328, "timers": {"training_iteration_time_ms": 13577980.593, "sample_time_ms": 13577578.254, "load_time_ms": 0.501, "load_throughput": 255531.134, "learn_time_ms": 401.242, "learn_throughput": 319.009, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 3328, "num_env_steps_trained": 3328, "num_agent_steps_sampled": 3328, "num_agent_steps_trained": 3328}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "default", "date": "2023-11-04_22-56-29", "timestamp": 1699127789, "time_this_iter_s": 14100.199646234512, "time_total_s": 368090.92352986336, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 368090.92352986336, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 9.495585164561998, "ram_util_percent": 51.46828577110471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7076318025588989, "cur_kl_coeff": 2.9802322387695322e-09, "cur_lr": 4.999999999999999e-05, "total_loss": 9.621594619750976, "policy_loss": -0.005623387141774098, "vf_loss": 9.627218023935955, "vf_explained_var": -6.854534149169922e-07, "kl": 0.0007631441370297883, "entropy": 1.8440240184466044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 795.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3456, "num_env_steps_trained": 3456, "num_agent_steps_sampled": 3456, "num_agent_steps_trained": 3456}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.35601880805409, "episode_len_mean": 127.96296296296296, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4526165323819012, "mean_inference_ms": 2.2148394577823787, "mean_action_processing_ms": 0.1686919961788252, "mean_env_wait_ms": 110371.65551961456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.35601880805409, "episode_len_mean": 127.96296296296296, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4526165323819012, "mean_inference_ms": 2.2148394577823787, "mean_action_processing_ms": 0.1686919961788252, "mean_env_wait_ms": 110371.65551961456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3456, "num_agent_steps_trained": 3456, "num_env_steps_sampled": 3456, "num_env_steps_trained": 3456, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008499208200563537, "num_env_steps_trained_throughput_per_sec": 0.008499208200563537, "timesteps_total": 3456, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 3456, "timers": {"training_iteration_time_ms": 13740075.378, "sample_time_ms": 13739671.969, "load_time_ms": 0.502, "load_throughput": 255009.221, "learn_time_ms": 402.309, "learn_throughput": 318.164, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 3456, "num_env_steps_trained": 3456, "num_agent_steps_sampled": 3456, "num_agent_steps_trained": 3456}, "done": false, "episodes_total": 27, "training_iteration": 27, "trial_id": "default", "date": "2023-11-05_03-07-29", "timestamp": 1699142849, "time_this_iter_s": 15060.226949930191, "time_total_s": 383151.15047979355, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 383151.15047979355, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 9.7503281664572, "ram_util_percent": 51.25284178187403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9356493989626566, "cur_kl_coeff": 1.4901161193847661e-09, "cur_lr": 4.999999999999999e-05, "total_loss": 9.440569082895914, "policy_loss": -0.00835870960727334, "vf_loss": 9.44892791112264, "vf_explained_var": -3.7868817647298176e-06, "kl": 0.0009914052484721954, "entropy": 1.8413681983947754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.60635379818595, "episode_len_mean": 127.96428571428571, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.452080627580768, "mean_inference_ms": 2.214211997653783, "mean_action_processing_ms": 0.16845391946253158, "mean_env_wait_ms": 110372.78871694593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.60635379818595, "episode_len_mean": 127.96428571428571, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.452080627580768, "mean_inference_ms": 2.214211997653783, "mean_action_processing_ms": 0.16845391946253158, "mean_env_wait_ms": 110372.78871694593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00809646230872721, "num_env_steps_trained_throughput_per_sec": 0.00809646230872721, "timesteps_total": 3584, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 14144809.686, "sample_time_ms": 14144425.072, "load_time_ms": 0.511, "load_throughput": 250663.42, "learn_time_ms": 383.493, "learn_throughput": 333.774, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "default", "date": "2023-11-05_07-30-59", "timestamp": 1699158659, "time_this_iter_s": 15809.374423980713, "time_total_s": 398960.52490377426, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 398960.52490377426, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 10.040462043277758, "ram_util_percent": 51.47263213905641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2743658185005189, "cur_kl_coeff": 7.450580596923831e-10, "cur_lr": 4.999999999999999e-05, "total_loss": 9.507484753926596, "policy_loss": -0.004739028494805097, "vf_loss": 9.51222365697225, "vf_explained_var": -6.670554478963217e-05, "kl": 0.0007456938357790932, "entropy": 1.825741950670878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3712, "num_env_steps_trained": 3712, "num_agent_steps_sampled": 3712, "num_agent_steps_trained": 3712}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.69097188149972, "episode_len_mean": 127.96551724137932, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45156994030663256, "mean_inference_ms": 2.2136064363259167, "mean_action_processing_ms": 0.168221945509499, "mean_env_wait_ms": 110380.23610856033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.69097188149972, "episode_len_mean": 127.96551724137932, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45156994030663256, "mean_inference_ms": 2.2136064363259167, "mean_action_processing_ms": 0.168221945509499, "mean_env_wait_ms": 110380.23610856033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3712, "num_agent_steps_trained": 3712, "num_env_steps_sampled": 3712, "num_env_steps_trained": 3712, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008516940539435193, "num_env_steps_trained_throughput_per_sec": 0.008516940539435193, "timesteps_total": 3712, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 3712, "timers": {"training_iteration_time_ms": 14087783.416, "sample_time_ms": 14087391.352, "load_time_ms": 0.515, "load_throughput": 248631.923, "learn_time_ms": 390.934, "learn_throughput": 327.421, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 3712, "num_env_steps_trained": 3712, "num_agent_steps_sampled": 3712, "num_agent_steps_trained": 3712}, "done": false, "episodes_total": 29, "training_iteration": 29, "trial_id": "default", "date": "2023-11-05_11-41-28", "timestamp": 1699173688, "time_this_iter_s": 15028.871516227722, "time_total_s": 413989.396420002, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 413989.396420002, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 9.235376434368877, "ram_util_percent": 51.36855583543242}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49936899145444236, "cur_kl_coeff": 3.7252902984619153e-10, "cur_lr": 4.999999999999999e-05, "total_loss": 9.335533587137858, "policy_loss": -0.0038535935493807, "vf_loss": 9.339387162526448, "vf_explained_var": -1.119375228881836e-05, "kl": 0.00045024667870166015, "entropy": 1.8256857633590697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 885.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.81474326984127, "episode_len_mean": 127.96666666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45107937731642794, "mean_inference_ms": 2.213049906886916, "mean_action_processing_ms": 0.16800215229641066, "mean_env_wait_ms": 110376.44647902998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 79.81474326984127, "episode_len_mean": 127.96666666666667, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45107937731642794, "mean_inference_ms": 2.213049906886916, "mean_action_processing_ms": 0.16800215229641066, "mean_env_wait_ms": 110376.44647902998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840, "num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009829981247358668, "num_env_steps_trained_throughput_per_sec": 0.009829981247358668, "timesteps_total": 3840, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 3840, "timers": {"training_iteration_time_ms": 13767011.107, "sample_time_ms": 13766616.058, "load_time_ms": 0.492, "load_throughput": 260149.688, "learn_time_ms": 393.947, "learn_throughput": 324.917, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 3840, "num_env_steps_trained": 3840, "num_agent_steps_sampled": 3840, "num_agent_steps_trained": 3840}, "done": false, "episodes_total": 30, "training_iteration": 30, "trial_id": "default", "date": "2023-11-05_15-18-29", "timestamp": 1699186709, "time_this_iter_s": 13021.38854765892, "time_total_s": 427010.7849676609, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 427010.7849676609, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 9.155935397039029, "ram_util_percent": 51.44159892328398}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7016304433345795, "cur_kl_coeff": 1.8626451492309577e-10, "cur_lr": 4.999999999999999e-05, "total_loss": 9.608648904164632, "policy_loss": -0.008414053047696749, "vf_loss": 9.617063045501709, "vf_explained_var": 1.926422119140625e-05, "kl": 0.001783617667327538, "entropy": 1.8473023533821107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 915.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 3968, "num_env_steps_trained": 3968, "num_agent_steps_sampled": 3968, "num_agent_steps_trained": 3968}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 80.24630076804915, "episode_len_mean": 127.96774193548387, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4506283333061133, "mean_inference_ms": 2.2125440628271917, "mean_action_processing_ms": 0.16779028586082562, "mean_env_wait_ms": 110379.1628407024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 54.59148539682539, "episode_reward_mean": 80.24630076804915, "episode_len_mean": 127.96774193548387, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4506283333061133, "mean_inference_ms": 2.2125440628271917, "mean_action_processing_ms": 0.16779028586082562, "mean_env_wait_ms": 110379.1628407024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3968, "num_agent_steps_trained": 3968, "num_env_steps_sampled": 3968, "num_env_steps_trained": 3968, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008593262078379295, "num_env_steps_trained_throughput_per_sec": 0.008593262078379295, "timesteps_total": 3968, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 3968, "timers": {"training_iteration_time_ms": 14029456.868, "sample_time_ms": 14029064.462, "load_time_ms": 0.47, "load_throughput": 272067.558, "learn_time_ms": 391.356, "learn_throughput": 327.068, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 3968, "num_env_steps_trained": 3968, "num_agent_steps_sampled": 3968, "num_agent_steps_trained": 3968}, "done": false, "episodes_total": 31, "training_iteration": 31, "trial_id": "default", "date": "2023-11-05_19-26-44", "timestamp": 1699201604, "time_this_iter_s": 14895.39168381691, "time_total_s": 441906.1766514778, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 441906.1766514778, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 9.044145331325302, "ram_util_percent": 51.36282003012048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7547337293624878, "cur_kl_coeff": 9.313225746154788e-11, "cur_lr": 4.999999999999999e-05, "total_loss": 9.428190231323242, "policy_loss": -0.00820443257689476, "vf_loss": 9.43639481862386, "vf_explained_var": -0.0004740635553995768, "kl": 0.0012400194448370409, "entropy": 1.8444730202356974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 46.53050146825396, "episode_reward_mean": 79.19268203993056, "episode_len_mean": 127.96875, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4501821732682594, "mean_inference_ms": 2.2120112655060584, "mean_action_processing_ms": 0.1675808515454279, "mean_env_wait_ms": 110384.2094249812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 46.53050146825396, "episode_reward_mean": 79.19268203993056, "episode_len_mean": 127.96875, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4501821732682594, "mean_inference_ms": 2.2120112655060584, "mean_action_processing_ms": 0.1675808515454279, "mean_env_wait_ms": 110384.2094249812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008646390040890973, "num_env_steps_trained_throughput_per_sec": 0.008646390040890973, "timesteps_total": 4096, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 14219992.788, "sample_time_ms": 14219597.089, "load_time_ms": 0.499, "load_throughput": 256471.08, "learn_time_ms": 394.616, "learn_throughput": 324.366, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "default", "date": "2023-11-05_23-33-28", "timestamp": 1699216408, "time_this_iter_s": 14803.866535663605, "time_total_s": 456710.0431871414, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 456710.0431871414, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 9.56462565705356, "ram_util_percent": 51.5996779845622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5728279789288838, "cur_kl_coeff": 4.656612873077394e-11, "cur_lr": 4.999999999999999e-05, "total_loss": 8.812557729085286, "policy_loss": -0.005025534238666296, "vf_loss": 8.817583306630452, "vf_explained_var": 8.10245672861735e-05, "kl": 0.0015877906984921235, "entropy": 1.8238321820894876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 975.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4224, "num_env_steps_trained": 4224, "num_agent_steps_sampled": 4224, "num_agent_steps_trained": 4224}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 46.53050146825396, "episode_reward_mean": 79.14796198653198, "episode_len_mean": 127.96969696969697, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.449746636291337, "mean_inference_ms": 2.211493705248217, "mean_action_processing_ms": 0.16737740407347035, "mean_env_wait_ms": 110398.06068871314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 46.53050146825396, "episode_reward_mean": 79.14796198653198, "episode_len_mean": 127.96969696969697, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.449746636291337, "mean_inference_ms": 2.211493705248217, "mean_action_processing_ms": 0.16737740407347035, "mean_env_wait_ms": 110398.06068871314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4224, "num_agent_steps_trained": 4224, "num_env_steps_sampled": 4224, "num_env_steps_trained": 4224, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008252661548101042, "num_env_steps_trained_throughput_per_sec": 0.008252661548101042, "timesteps_total": 4224, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 4224, "timers": {"training_iteration_time_ms": 14650065.975, "sample_time_ms": 14649668.276, "load_time_ms": 0.49, "load_throughput": 261047.803, "learn_time_ms": 396.626, "learn_throughput": 322.722, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 4224, "num_env_steps_trained": 4224, "num_agent_steps_sampled": 4224, "num_agent_steps_trained": 4224}, "done": false, "episodes_total": 33, "training_iteration": 33, "trial_id": "default", "date": "2023-11-06_03-51-59", "timestamp": 1699231919, "time_this_iter_s": 15510.148263216019, "time_total_s": 472220.19145035744, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 472220.19145035744, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 9.988158192090395, "ram_util_percent": 51.685215819209034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.793976291020711, "cur_kl_coeff": 2.328306436538697e-11, "cur_lr": 4.999999999999999e-05, "total_loss": 8.625671990712483, "policy_loss": -0.01770423591757814, "vf_loss": 8.643376223246257, "vf_explained_var": 0.00011566281318664551, "kl": 0.0026310067766947515, "entropy": 1.848034183184306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1005.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4352, "num_env_steps_trained": 4352, "num_agent_steps_sampled": 4352, "num_agent_steps_trained": 4352}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.0892839764239, "episode_len_mean": 127.97058823529412, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4493327465019361, "mean_inference_ms": 2.2109493591567166, "mean_action_processing_ms": 0.16718349035623425, "mean_env_wait_ms": 110408.14805779666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.0892839764239, "episode_len_mean": 127.97058823529412, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4493327465019361, "mean_inference_ms": 2.2109493591567166, "mean_action_processing_ms": 0.16718349035623425, "mean_env_wait_ms": 110408.14805779666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4352, "num_agent_steps_trained": 4352, "num_env_steps_sampled": 4352, "num_env_steps_trained": 4352, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00934387134810006, "num_env_steps_trained_throughput_per_sec": 0.00934387134810006, "timesteps_total": 4352, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 4352, "timers": {"training_iteration_time_ms": 14506838.088, "sample_time_ms": 14506466.544, "load_time_ms": 0.499, "load_throughput": 256262.965, "learn_time_ms": 370.461, "learn_throughput": 345.515, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 4352, "num_env_steps_trained": 4352, "num_agent_steps_sampled": 4352, "num_agent_steps_trained": 4352}, "done": false, "episodes_total": 34, "training_iteration": 34, "trial_id": "default", "date": "2023-11-06_07-40-17", "timestamp": 1699245617, "time_this_iter_s": 13698.819254398346, "time_total_s": 485919.0107047558, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 485919.0107047558, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 9.862939460621257, "ram_util_percent": 51.70306534977739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.539886506398519, "cur_kl_coeff": 1.1641532182693485e-11, "cur_lr": 4.999999999999999e-05, "total_loss": 9.517404460906983, "policy_loss": -0.0037960862430433434, "vf_loss": 9.521200625101725, "vf_explained_var": -0.0023663798967997235, "kl": 0.0011472682956629398, "entropy": 1.8862331628799438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4480, "num_env_steps_trained": 4480, "num_agent_steps_sampled": 4480, "num_agent_steps_trained": 4480}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.67021995351473, "episode_len_mean": 127.94285714285714, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4497258511768346, "mean_inference_ms": 2.2130229622356374, "mean_action_processing_ms": 0.1669998090304494, "mean_env_wait_ms": 110072.05628378452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.67021995351473, "episode_len_mean": 127.94285714285714, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4497258511768346, "mean_inference_ms": 2.2130229622356374, "mean_action_processing_ms": 0.1669998090304494, "mean_env_wait_ms": 110072.05628378452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480, "num_agent_steps_trained": 4480, "num_env_steps_sampled": 4480, "num_env_steps_trained": 4480, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.003978775699754145, "num_env_steps_trained_throughput_per_sec": 0.003978775699754145, "timesteps_total": 4480, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 4480, "timers": {"training_iteration_time_ms": 16409898.189, "sample_time_ms": 16409525.717, "load_time_ms": 0.488, "load_throughput": 262067.222, "learn_time_ms": 371.405, "learn_throughput": 344.637, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 4480, "num_env_steps_trained": 4480, "num_agent_steps_sampled": 4480, "num_agent_steps_trained": 4480}, "done": false, "episodes_total": 35, "training_iteration": 35, "trial_id": "default", "date": "2023-11-06_16-36-28", "timestamp": 1699277788, "time_this_iter_s": 32170.70067715645, "time_total_s": 518089.71138191223, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 518089.71138191223, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 21.18561872180943, "ram_util_percent": 55.719743751770416}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9566253582636516, "cur_kl_coeff": 5.820766091346743e-12, "cur_lr": 4.999999999999999e-05, "total_loss": 9.12736956278483, "policy_loss": -0.013686807764073213, "vf_loss": 9.141056219736734, "vf_explained_var": -3.619988759358724e-05, "kl": 0.0018439979991550597, "entropy": 1.9074692845344543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1065.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.5782085989859, "episode_len_mean": 127.94444444444444, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44995490288851436, "mean_inference_ms": 2.2135964661808454, "mean_action_processing_ms": 0.1671570920728621, "mean_env_wait_ms": 110120.80469059049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.5782085989859, "episode_len_mean": 127.94444444444444, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44995490288851436, "mean_inference_ms": 2.2135964661808454, "mean_action_processing_ms": 0.1671570920728621, "mean_env_wait_ms": 110120.80469059049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00801997733675969, "num_env_steps_trained_throughput_per_sec": 0.00801997733675969, "timesteps_total": 4608, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 16595892.761, "sample_time_ms": 16595524.299, "load_time_ms": 0.499, "load_throughput": 256740.908, "learn_time_ms": 367.379, "learn_throughput": 348.414, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "default", "date": "2023-11-06_21-02-28", "timestamp": 1699293748, "time_this_iter_s": 15960.145396232605, "time_total_s": 534049.8567781448, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 534049.8567781448, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 28.62013440505996, "ram_util_percent": 60.01450344797294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2425838430722556, "cur_kl_coeff": 2.9103830456733713e-12, "cur_lr": 4.999999999999999e-05, "total_loss": 9.30309985478719, "policy_loss": -0.005240464815869927, "vf_loss": 9.308340485890707, "vf_explained_var": 2.0503997802734375e-05, "kl": 0.0006551303081020403, "entropy": 1.91989324092865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1095.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4736, "num_env_steps_trained": 4736, "num_agent_steps_sampled": 4736, "num_agent_steps_trained": 4736}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.50510217932218, "episode_len_mean": 127.94594594594595, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45009204691817123, "mean_inference_ms": 2.212962826011688, "mean_action_processing_ms": 0.16717617798092255, "mean_env_wait_ms": 110116.99512738528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.50510217932218, "episode_len_mean": 127.94594594594595, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45009204691817123, "mean_inference_ms": 2.212962826011688, "mean_action_processing_ms": 0.16717617798092255, "mean_env_wait_ms": 110116.99512738528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4736, "num_agent_steps_trained": 4736, "num_env_steps_sampled": 4736, "num_env_steps_trained": 4736, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009234134754799363, "num_env_steps_trained_throughput_per_sec": 0.009234134754799363, "timesteps_total": 4736, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 4736, "timers": {"training_iteration_time_ms": 16476031.393, "sample_time_ms": 16475525.844, "load_time_ms": 0.498, "load_throughput": 256826.881, "learn_time_ms": 504.457, "learn_throughput": 253.738, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 4736, "num_env_steps_trained": 4736, "num_agent_steps_sampled": 4736, "num_agent_steps_trained": 4736}, "done": false, "episodes_total": 37, "training_iteration": 37, "trial_id": "default", "date": "2023-11-07_00-53-30", "timestamp": 1699307610, "time_this_iter_s": 13861.613314151764, "time_total_s": 547911.4700922966, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 547911.4700922966, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 37.47969555982603, "ram_util_percent": 69.42745018711439}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.604255865017573, "cur_kl_coeff": 1.4551915228366857e-12, "cur_lr": 4.999999999999999e-05, "total_loss": 9.554046821594238, "policy_loss": -0.011395732872188091, "vf_loss": 9.565442625681559, "vf_explained_var": -4.891157150268555e-05, "kl": 0.002165783316498467, "entropy": 1.8973066886266072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4864, "num_env_steps_trained": 4864, "num_agent_steps_sampled": 4864, "num_agent_steps_trained": 4864}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.83617914995823, "episode_len_mean": 127.94736842105263, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4506260018037783, "mean_inference_ms": 2.212307476168583, "mean_action_processing_ms": 0.16719099513725819, "mean_env_wait_ms": 110214.30177280534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.83617914995823, "episode_len_mean": 127.94736842105263, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4506260018037783, "mean_inference_ms": 2.212307476168583, "mean_action_processing_ms": 0.16719099513725819, "mean_env_wait_ms": 110214.30177280534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4864, "num_agent_steps_trained": 4864, "num_env_steps_sampled": 4864, "num_env_steps_trained": 4864, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.007901699949072888, "num_env_steps_trained_throughput_per_sec": 0.007901699949072888, "timesteps_total": 4864, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 4864, "timers": {"training_iteration_time_ms": 16514998.591, "sample_time_ms": 16514495.503, "load_time_ms": 0.491, "load_throughput": 260920.933, "learn_time_ms": 502.019, "learn_throughput": 254.971, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 4864, "num_env_steps_trained": 4864, "num_agent_steps_sampled": 4864, "num_agent_steps_trained": 4864}, "done": false, "episodes_total": 38, "training_iteration": 38, "trial_id": "default", "date": "2023-11-07_05-23-29", "timestamp": 1699323809, "time_this_iter_s": 16199.046393871307, "time_total_s": 564110.5164861679, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 564110.5164861679, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 37.90785374296842, "ram_util_percent": 70.66882302033751}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1486224810282388, "cur_kl_coeff": 7.275957614183428e-13, "cur_lr": 4.999999999999999e-05, "total_loss": 9.445015907287598, "policy_loss": -0.002885137964040041, "vf_loss": 9.447901185353597, "vf_explained_var": -1.6510486602783203e-05, "kl": 0.0005188339084270411, "entropy": 1.8845959782600403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1155.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 4992, "num_env_steps_trained": 4992, "num_agent_steps_sampled": 4992, "num_agent_steps_trained": 4992}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.6123068040293, "episode_len_mean": 127.94871794871794, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45111581942704104, "mean_inference_ms": 2.21102535691013, "mean_action_processing_ms": 0.16715140624657035, "mean_env_wait_ms": 110340.6959261588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.6123068040293, "episode_len_mean": 127.94871794871794, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45111581942704104, "mean_inference_ms": 2.21102535691013, "mean_action_processing_ms": 0.16715140624657035, "mean_env_wait_ms": 110340.6959261588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4992, "num_agent_steps_trained": 4992, "num_env_steps_sampled": 4992, "num_env_steps_trained": 4992, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008237064111514996, "num_env_steps_trained_throughput_per_sec": 0.008237064111514996, "timesteps_total": 4992, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 4992, "timers": {"training_iteration_time_ms": 16566063.225, "sample_time_ms": 16565560.981, "load_time_ms": 0.49, "load_throughput": 261454.618, "learn_time_ms": 501.175, "learn_throughput": 255.4, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 4992, "num_env_steps_trained": 4992, "num_agent_steps_sampled": 4992, "num_agent_steps_trained": 4992}, "done": false, "episodes_total": 39, "training_iteration": 39, "trial_id": "default", "date": "2023-11-07_09-42-29", "timestamp": 1699339349, "time_this_iter_s": 15539.51930642128, "time_total_s": 579650.0357925892, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 579650.0357925892, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 37.771511706590886, "ram_util_percent": 71.83431226598097}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6338141987721125, "cur_kl_coeff": 3.637978807091714e-13, "cur_lr": 4.999999999999999e-05, "total_loss": 9.140872923533122, "policy_loss": -0.004140148653338353, "vf_loss": 9.1450133005778, "vf_explained_var": -2.789497375488281e-06, "kl": 0.0008257077197716474, "entropy": 1.901302663485209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1185.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.61198612003969, "episode_len_mean": 127.95, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4516952258995107, "mean_inference_ms": 2.209568510285272, "mean_action_processing_ms": 0.16712571891991718, "mean_env_wait_ms": 110397.73204818442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.61198612003969, "episode_len_mean": 127.95, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4516952258995107, "mean_inference_ms": 2.209568510285272, "mean_action_processing_ms": 0.16712571891991718, "mean_env_wait_ms": 110397.73204818442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009921733225393149, "num_env_steps_trained_throughput_per_sec": 0.009921733225393149, "timesteps_total": 5120, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 16554021.599, "sample_time_ms": 16553376.007, "load_time_ms": 0.5, "load_throughput": 255823.364, "learn_time_ms": 644.493, "learn_throughput": 198.606, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 40, "training_iteration": 40, "trial_id": "default", "date": "2023-11-07_13-17-30", "timestamp": 1699352250, "time_this_iter_s": 12900.972354650497, "time_total_s": 592551.0081472397, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 592551.0081472397, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 37.99484351227993, "ram_util_percent": 72.16142143012388}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6695388595263163, "cur_kl_coeff": 1.818989403545857e-13, "cur_lr": 4.999999999999999e-05, "total_loss": 9.55455929438273, "policy_loss": -0.0031291812968750796, "vf_loss": 9.557688522338868, "vf_explained_var": -0.00023185014724731446, "kl": 0.0002764978208991427, "entropy": 1.9102307279904684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 5248, "num_env_steps_trained": 5248, "num_agent_steps_sampled": 5248, "num_agent_steps_trained": 5248}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.49577461091754, "episode_len_mean": 127.95121951219512, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4521798042520251, "mean_inference_ms": 2.208264616900752, "mean_action_processing_ms": 0.16709283943526476, "mean_env_wait_ms": 110396.0641383759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.49577461091754, "episode_len_mean": 127.95121951219512, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4521798042520251, "mean_inference_ms": 2.208264616900752, "mean_action_processing_ms": 0.16709283943526476, "mean_env_wait_ms": 110396.0641383759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5248, "num_agent_steps_trained": 5248, "num_env_steps_sampled": 5248, "num_env_steps_trained": 5248, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.010414147686415885, "num_env_steps_trained_throughput_per_sec": 0.010414147686415885, "timesteps_total": 5248, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 5248, "timers": {"training_iteration_time_ms": 16293579.706, "sample_time_ms": 16292849.45, "load_time_ms": 0.508, "load_throughput": 251862.879, "learn_time_ms": 729.142, "learn_throughput": 175.549, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 5248, "num_env_steps_trained": 5248, "num_agent_steps_sampled": 5248, "num_agent_steps_trained": 5248}, "done": false, "episodes_total": 41, "training_iteration": 41, "trial_id": "default", "date": "2023-11-07_16-42-21", "timestamp": 1699364541, "time_this_iter_s": 12290.972975492477, "time_total_s": 604841.9811227322, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 604841.9811227322, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 38.107385650735715, "ram_util_percent": 72.67254477016084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6497560461362203, "cur_kl_coeff": 9.094947017729285e-14, "cur_lr": 4.999999999999999e-05, "total_loss": 9.385867404937745, "policy_loss": -0.007634182243297497, "vf_loss": 9.393501504262288, "vf_explained_var": -2.0364920298258465e-05, "kl": 0.0010404682858885887, "entropy": 1.8966171185175578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1245.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.91073823412698, "episode_len_mean": 127.95238095238095, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4525736642753436, "mean_inference_ms": 2.20682678840279, "mean_action_processing_ms": 0.16715917952165502, "mean_env_wait_ms": 110431.37095507726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.91073823412698, "episode_len_mean": 127.95238095238095, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4525736642753436, "mean_inference_ms": 2.20682678840279, "mean_action_processing_ms": 0.16715917952165502, "mean_env_wait_ms": 110431.37095507726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008092180824736717, "num_env_steps_trained_throughput_per_sec": 0.008092180824736717, "timesteps_total": 5376, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 16394966.947, "sample_time_ms": 16394218.009, "load_time_ms": 0.509, "load_throughput": 251438.232, "learn_time_ms": 747.805, "learn_throughput": 171.168, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 42, "training_iteration": 42, "trial_id": "default", "date": "2023-11-07_21-05-59", "timestamp": 1699380359, "time_this_iter_s": 15817.74038028717, "time_total_s": 620659.7215030193, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 620659.7215030193, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 37.8795080877465, "ram_util_percent": 73.11653445601596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9937724272410074, "cur_kl_coeff": 4.547473508864643e-14, "cur_lr": 4.999999999999999e-05, "total_loss": 9.517826557159424, "policy_loss": -0.0019422182813286781, "vf_loss": 9.519768746693929, "vf_explained_var": -1.1559327443440755e-05, "kl": 0.00042980449713165094, "entropy": 1.8815364519755045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1275.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 5504, "num_env_steps_trained": 5504, "num_agent_steps_sampled": 5504, "num_agent_steps_trained": 5504}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.97591438353635, "episode_len_mean": 127.95348837209302, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4528637067883147, "mean_inference_ms": 2.2054342493603545, "mean_action_processing_ms": 0.16729958302051837, "mean_env_wait_ms": 110450.56346676446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.97591438353635, "episode_len_mean": 127.95348837209302, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4528637067883147, "mean_inference_ms": 2.2054342493603545, "mean_action_processing_ms": 0.16729958302051837, "mean_env_wait_ms": 110450.56346676446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5504, "num_agent_steps_trained": 5504, "num_env_steps_sampled": 5504, "num_env_steps_trained": 5504, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009254853367231936, "num_env_steps_trained_throughput_per_sec": 0.009254853367231936, "timesteps_total": 5504, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 5504, "timers": {"training_iteration_time_ms": 16227010.28, "sample_time_ms": 16226247.274, "load_time_ms": 0.516, "load_throughput": 247828.515, "learn_time_ms": 761.855, "learn_throughput": 168.011, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 5504, "num_env_steps_trained": 5504, "num_agent_steps_sampled": 5504, "num_agent_steps_trained": 5504}, "done": false, "episodes_total": 43, "training_iteration": 43, "trial_id": "default", "date": "2023-11-08_00-56-29", "timestamp": 1699394189, "time_this_iter_s": 13830.581733465195, "time_total_s": 634490.3032364845, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 634490.3032364845, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 39.135173077897726, "ram_util_percent": 73.65736658050784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32908107539017994, "cur_kl_coeff": 2.2737367544323214e-14, "cur_lr": 4.999999999999999e-05, "total_loss": 9.082057444254557, "policy_loss": -0.002722985421617826, "vf_loss": 9.084780470530193, "vf_explained_var": -1.0172526041666667e-06, "kl": 0.0003069865338754122, "entropy": 1.8811023513476053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.3467017703824, "episode_len_mean": 127.95454545454545, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4531147529336463, "mean_inference_ms": 2.203915110145186, "mean_action_processing_ms": 0.16739795920217382, "mean_env_wait_ms": 110479.7651147598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.3467017703824, "episode_len_mean": 127.95454545454545, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4531147529336463, "mean_inference_ms": 2.203915110145186, "mean_action_processing_ms": 0.16739795920217382, "mean_env_wait_ms": 110479.7651147598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008611074777824013, "num_env_steps_trained_throughput_per_sec": 0.008611074777824013, "timesteps_total": 5632, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 16343586.29, "sample_time_ms": 16342820.301, "load_time_ms": 0.506, "load_throughput": 252811.693, "learn_time_ms": 764.819, "learn_throughput": 167.36, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "done": false, "episodes_total": 44, "training_iteration": 44, "trial_id": "default", "date": "2023-11-08_05-04-14", "timestamp": 1699409054, "time_this_iter_s": 14864.579471588135, "time_total_s": 649354.8827080727, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 649354.8827080727, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 39.91766092902618, "ram_util_percent": 74.21562367366187}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46249082187811535, "cur_kl_coeff": 1.1368683772161607e-14, "cur_lr": 4.999999999999999e-05, "total_loss": 9.550482400258382, "policy_loss": -0.0028303187961379686, "vf_loss": 9.553312873840332, "vf_explained_var": -9.389321009318034e-05, "kl": 0.0002828410208773372, "entropy": 1.8829646587371827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1335.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 5760, "num_env_steps_trained": 5760, "num_agent_steps_sampled": 5760, "num_agent_steps_trained": 5760}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.1710396058201, "episode_len_mean": 127.95555555555555, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45330171768886934, "mean_inference_ms": 2.2024790812906407, "mean_action_processing_ms": 0.1674541108429047, "mean_env_wait_ms": 110458.9141093912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.1710396058201, "episode_len_mean": 127.95555555555555, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45330171768886934, "mean_inference_ms": 2.2024790812906407, "mean_action_processing_ms": 0.1674541108429047, "mean_env_wait_ms": 110458.9141093912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760, "num_agent_steps_trained": 5760, "num_env_steps_sampled": 5760, "num_env_steps_trained": 5760, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.011328414173021443, "num_env_steps_trained_throughput_per_sec": 0.011328414173021443, "timesteps_total": 5760, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 5760, "timers": {"training_iteration_time_ms": 14256418.466, "sample_time_ms": 14255612.964, "load_time_ms": 0.505, "load_throughput": 253444.23, "learn_time_ms": 804.337, "learn_throughput": 159.137, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 5760, "num_env_steps_trained": 5760, "num_agent_steps_sampled": 5760, "num_agent_steps_trained": 5760}, "done": false, "episodes_total": 45, "training_iteration": 45, "trial_id": "default", "date": "2023-11-08_08-12-33", "timestamp": 1699420353, "time_this_iter_s": 11299.022525310516, "time_total_s": 660653.9052333832, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 660653.9052333832, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 40.4858055710652, "ram_util_percent": 74.4428872758856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6410703599452973, "cur_kl_coeff": 5.684341886080803e-15, "cur_lr": 4.999999999999999e-05, "total_loss": 8.51123701731364, "policy_loss": -0.006456183642148972, "vf_loss": 8.51769307454427, "vf_explained_var": -2.0543734232584637e-05, "kl": 0.0006799276770683112, "entropy": 1.8847883303960165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1365.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 5888, "num_env_steps_trained": 5888, "num_agent_steps_sampled": 5888, "num_agent_steps_trained": 5888}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.39391826863353, "episode_len_mean": 127.95652173913044, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4534754982228599, "mean_inference_ms": 2.2010406741536186, "mean_action_processing_ms": 0.1674973199381907, "mean_env_wait_ms": 110450.68599822729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.39391826863353, "episode_len_mean": 127.95652173913044, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4534754982228599, "mean_inference_ms": 2.2010406741536186, "mean_action_processing_ms": 0.1674973199381907, "mean_env_wait_ms": 110450.68599822729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5888, "num_agent_steps_trained": 5888, "num_env_steps_sampled": 5888, "num_env_steps_trained": 5888, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00848080484110102, "num_env_steps_trained_throughput_per_sec": 0.00848080484110102, "timesteps_total": 5888, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 5888, "timers": {"training_iteration_time_ms": 14169694.695, "sample_time_ms": 14168874.177, "load_time_ms": 0.49, "load_throughput": 261314.632, "learn_time_ms": 819.38, "learn_throughput": 156.216, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 5888, "num_env_steps_trained": 5888, "num_agent_steps_sampled": 5888, "num_agent_steps_trained": 5888}, "done": false, "episodes_total": 46, "training_iteration": 46, "trial_id": "default", "date": "2023-11-08_12-24-06", "timestamp": 1699435446, "time_this_iter_s": 15092.907791137695, "time_total_s": 675746.8130245209, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 675746.8130245209, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 40.58140733859731, "ram_util_percent": 75.19912679981421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8775916616121928, "cur_kl_coeff": 2.8421709430404017e-15, "cur_lr": 4.999999999999999e-05, "total_loss": 9.542480691274006, "policy_loss": -0.007131491135805845, "vf_loss": 9.549612522125244, "vf_explained_var": -0.0001887679100036621, "kl": 0.0010101817854471543, "entropy": 1.8951321045557659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 6016, "num_env_steps_trained": 6016, "num_agent_steps_sampled": 6016, "num_agent_steps_trained": 6016}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.98038414555893, "episode_len_mean": 127.95744680851064, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4536075899235455, "mean_inference_ms": 2.1994208663356014, "mean_action_processing_ms": 0.16751337193814453, "mean_env_wait_ms": 110432.03205884127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.98038414555893, "episode_len_mean": 127.95744680851064, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4536075899235455, "mean_inference_ms": 2.1994208663356014, "mean_action_processing_ms": 0.16751337193814453, "mean_env_wait_ms": 110432.03205884127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6016, "num_agent_steps_trained": 6016, "num_env_steps_sampled": 6016, "num_env_steps_trained": 6016, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009679592558990653, "num_env_steps_trained_throughput_per_sec": 0.009679592558990653, "timesteps_total": 6016, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 6016, "timers": {"training_iteration_time_ms": 14105903.123, "sample_time_ms": 14105208.707, "load_time_ms": 0.479, "load_throughput": 267246.21, "learn_time_ms": 693.298, "learn_throughput": 184.625, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 6016, "num_env_steps_trained": 6016, "num_agent_steps_sampled": 6016, "num_agent_steps_trained": 6016}, "done": false, "episodes_total": 47, "training_iteration": 47, "trial_id": "default", "date": "2023-11-08_16-04-30", "timestamp": 1699448670, "time_this_iter_s": 13223.697687387466, "time_total_s": 688970.5107119083, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 688970.5107119083, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 39.84616485555261, "ram_util_percent": 75.68708719851577}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8186935822168986, "cur_kl_coeff": 1.4210854715202008e-15, "cur_lr": 4.999999999999999e-05, "total_loss": 9.542591540018718, "policy_loss": -0.006325758590052525, "vf_loss": 9.548917166392009, "vf_explained_var": -2.0070870717366537e-05, "kl": 0.0011384515960647453, "entropy": 1.9049074451128643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1425.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.26013370866401, "episode_len_mean": 127.95833333333333, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4537382407297604, "mean_inference_ms": 2.197884257808788, "mean_action_processing_ms": 0.16753154188580335, "mean_env_wait_ms": 110409.067198421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.26013370866401, "episode_len_mean": 127.95833333333333, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4537382407297604, "mean_inference_ms": 2.197884257808788, "mean_action_processing_ms": 0.16753154188580335, "mean_env_wait_ms": 110409.067198421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00927604284489695, "num_env_steps_trained_throughput_per_sec": 0.00927604284489695, "timesteps_total": 6144, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 13865897.293, "sample_time_ms": 13865199.744, "load_time_ms": 0.482, "load_throughput": 265514.793, "learn_time_ms": 696.425, "learn_throughput": 183.796, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "episodes_total": 48, "training_iteration": 48, "trial_id": "default", "date": "2023-11-08_19-54-29", "timestamp": 1699462469, "time_this_iter_s": 13798.988265275955, "time_total_s": 702769.4989771843, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 702769.4989771843, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 39.054132588265176, "ram_util_percent": 73.98910337820675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6502311646938324, "cur_kl_coeff": 7.105427357601004e-16, "cur_lr": 4.999999999999999e-05, "total_loss": 9.51761474609375, "policy_loss": -0.0035448172750572366, "vf_loss": 9.521159648895264, "vf_explained_var": -4.206101099650065e-05, "kl": 0.0006962888605509458, "entropy": 1.914941386381785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1455.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 6272, "num_env_steps_trained": 6272, "num_agent_steps_sampled": 6272, "num_agent_steps_trained": 6272}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.02198962666019, "episode_len_mean": 127.95918367346938, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45384707323031825, "mean_inference_ms": 2.1962905362576137, "mean_action_processing_ms": 0.16753348457430278, "mean_env_wait_ms": 110371.83049832104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.02198962666019, "episode_len_mean": 127.95918367346938, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45384707323031825, "mean_inference_ms": 2.1962905362576137, "mean_action_processing_ms": 0.16753348457430278, "mean_env_wait_ms": 110371.83049832104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6272, "num_agent_steps_trained": 6272, "num_env_steps_sampled": 6272, "num_env_steps_trained": 6272, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.010169416157848138, "num_env_steps_trained_throughput_per_sec": 0.010169416157848138, "timesteps_total": 6272, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 6272, "timers": {"training_iteration_time_ms": 13570621.561, "sample_time_ms": 13569925.379, "load_time_ms": 0.507, "load_throughput": 252277.107, "learn_time_ms": 695.034, "learn_throughput": 184.164, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6272, "num_env_steps_trained": 6272, "num_agent_steps_sampled": 6272, "num_agent_steps_trained": 6272}, "done": false, "episodes_total": 49, "training_iteration": 49, "trial_id": "default", "date": "2023-11-08_23-24-15", "timestamp": 1699475055, "time_this_iter_s": 12586.761971473694, "time_total_s": 715356.260948658, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 715356.260948658, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 37.515170416573845, "ram_util_percent": 73.85641568278014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5854698181152344, "cur_kl_coeff": 3.552713678800502e-16, "cur_lr": 4.999999999999999e-05, "total_loss": 9.534622351328531, "policy_loss": -0.005731332503880064, "vf_loss": 9.540353870391845, "vf_explained_var": -4.1961669921875e-05, "kl": 0.000556760365301064, "entropy": 1.9218981544176736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.10777623333334, "episode_len_mean": 127.96, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4540080100248119, "mean_inference_ms": 2.1947152174787763, "mean_action_processing_ms": 0.1675213169308196, "mean_env_wait_ms": 110337.29327994458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 78.10777623333334, "episode_len_mean": 127.96, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4540080100248119, "mean_inference_ms": 2.1947152174787763, "mean_action_processing_ms": 0.1675213169308196, "mean_env_wait_ms": 110337.29327994458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008880757762257645, "num_env_steps_trained_throughput_per_sec": 0.008880757762257645, "timesteps_total": 6400, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 6400, "timers": {"training_iteration_time_ms": 13721842.835, "sample_time_ms": 13721280.254, "load_time_ms": 0.496, "load_throughput": 258272.436, "learn_time_ms": 561.469, "learn_throughput": 227.974, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "done": false, "episodes_total": 50, "training_iteration": 50, "trial_id": "default", "date": "2023-11-09_03-24-29", "timestamp": 1699489469, "time_this_iter_s": 14413.185097932816, "time_total_s": 729769.4460465908, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 729769.4460465908, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.41885608676621, "ram_util_percent": 74.19223773162784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0400523364543914, "cur_kl_coeff": 1.776356839400251e-16, "cur_lr": 4.999999999999999e-05, "total_loss": 9.448790359497071, "policy_loss": -0.0035659236212571463, "vf_loss": 9.45235611597697, "vf_explained_var": -0.0003430962562561035, "kl": 0.0002680909851430139, "entropy": 1.9224520126978557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1515.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 6528, "num_env_steps_trained": 6528, "num_agent_steps_sampled": 6528, "num_agent_steps_trained": 6528}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.65042961251167, "episode_len_mean": 127.96078431372548, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45414510430497845, "mean_inference_ms": 2.1930700743579408, "mean_action_processing_ms": 0.1675068024197778, "mean_env_wait_ms": 110302.46415439222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.65042961251167, "episode_len_mean": 127.96078431372548, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45414510430497845, "mean_inference_ms": 2.1930700743579408, "mean_action_processing_ms": 0.1675068024197778, "mean_env_wait_ms": 110302.46415439222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6528, "num_agent_steps_trained": 6528, "num_env_steps_sampled": 6528, "num_env_steps_trained": 6528, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00931519347751099, "num_env_steps_trained_throughput_per_sec": 0.00931519347751099, "timesteps_total": 6528, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 6528, "timers": {"training_iteration_time_ms": 13866844.822, "sample_time_ms": 13866325.87, "load_time_ms": 0.49, "load_throughput": 261174.797, "learn_time_ms": 517.854, "learn_throughput": 247.174, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6528, "num_env_steps_trained": 6528, "num_agent_steps_sampled": 6528, "num_agent_steps_trained": 6528}, "done": false, "episodes_total": 51, "training_iteration": 51, "trial_id": "default", "date": "2023-11-09_07-13-30", "timestamp": 1699503210, "time_this_iter_s": 13740.99266409874, "time_total_s": 743510.4387106895, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 743510.4387106895, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 35.372518110396896, "ram_util_percent": 74.3571676359555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7672772447268168, "cur_kl_coeff": 8.881784197001255e-17, "cur_lr": 4.999999999999999e-05, "total_loss": 9.362978649139404, "policy_loss": -0.004858252654472987, "vf_loss": 9.367836983998616, "vf_explained_var": -6.711483001708984e-06, "kl": 0.00036683414106543447, "entropy": 1.9178701400756837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1545.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.38707578449329, "episode_len_mean": 127.96153846153847, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4542463132566072, "mean_inference_ms": 2.191394300980218, "mean_action_processing_ms": 0.1674781350890389, "mean_env_wait_ms": 110252.45714003552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.38707578449329, "episode_len_mean": 127.96153846153847, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4542463132566072, "mean_inference_ms": 2.191394300980218, "mean_action_processing_ms": 0.1674781350890389, "mean_env_wait_ms": 110252.45714003552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.010776208453013374, "num_env_steps_trained_throughput_per_sec": 0.010776208453013374, "timesteps_total": 6656, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 13472872.794, "sample_time_ms": 13472354.18, "load_time_ms": 0.467, "load_throughput": 273941.684, "learn_time_ms": 517.561, "learn_throughput": 247.314, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "done": false, "episodes_total": 52, "training_iteration": 52, "trial_id": "default", "date": "2023-11-09_10-31-28", "timestamp": 1699515088, "time_this_iter_s": 11878.018904924393, "time_total_s": 755388.4576156139, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 755388.4576156139, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 35.710056657223795, "ram_util_percent": 74.64724386213409}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5930627624193827, "cur_kl_coeff": 4.4408920985006276e-17, "cur_lr": 4.999999999999999e-05, "total_loss": 8.835654417673746, "policy_loss": -0.004072947986423969, "vf_loss": 8.83972749710083, "vf_explained_var": 3.230969111124675e-05, "kl": 0.0003340145500866735, "entropy": 1.9205933173497518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 6784, "num_env_steps_trained": 6784, "num_agent_steps_sampled": 6784, "num_agent_steps_trained": 6784}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.16481639263253, "episode_len_mean": 127.9622641509434, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4543207709783339, "mean_inference_ms": 2.189866318952079, "mean_action_processing_ms": 0.16743937211374565, "mean_env_wait_ms": 110196.3484949659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.16481639263253, "episode_len_mean": 127.9622641509434, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4543207709783339, "mean_inference_ms": 2.189866318952079, "mean_action_processing_ms": 0.16743937211374565, "mean_env_wait_ms": 110196.3484949659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6784, "num_agent_steps_trained": 6784, "num_env_steps_sampled": 6784, "num_env_steps_trained": 6784, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009921572997883784, "num_env_steps_trained_throughput_per_sec": 0.009921572997883784, "timesteps_total": 6784, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 6784, "timers": {"training_iteration_time_ms": 13379932.693, "sample_time_ms": 13379430.874, "load_time_ms": 0.481, "load_throughput": 266172.986, "learn_time_ms": 500.746, "learn_throughput": 255.619, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6784, "num_env_steps_trained": 6784, "num_agent_steps_sampled": 6784, "num_agent_steps_trained": 6784}, "done": false, "episodes_total": 53, "training_iteration": 53, "trial_id": "default", "date": "2023-11-09_14-06-29", "timestamp": 1699527989, "time_this_iter_s": 12901.180809497833, "time_total_s": 768289.6384251118, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 768289.6384251118, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 12.694767726161368, "ram_util_percent": 51.074153762564514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5322650651137034, "cur_kl_coeff": 2.2204460492503138e-17, "cur_lr": 4.999999999999999e-05, "total_loss": 9.521052646636964, "policy_loss": -0.0037421370546023053, "vf_loss": 9.52479492823283, "vf_explained_var": 1.1581182479858399e-05, "kl": 0.0003430144619718097, "entropy": 1.9230860551198323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1605.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 6912, "num_env_steps_trained": 6912, "num_agent_steps_sampled": 6912, "num_agent_steps_trained": 6912}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.9540321707819, "episode_len_mean": 127.96296296296296, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45437079539365716, "mean_inference_ms": 2.1884344905890916, "mean_action_processing_ms": 0.16738766173810127, "mean_env_wait_ms": 110139.45375955623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.9540321707819, "episode_len_mean": 127.96296296296296, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45437079539365716, "mean_inference_ms": 2.1884344905890916, "mean_action_processing_ms": 0.16738766173810127, "mean_env_wait_ms": 110139.45375955623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6912, "num_agent_steps_trained": 6912, "num_env_steps_sampled": 6912, "num_env_steps_trained": 6912, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009523965866588512, "num_env_steps_trained_throughput_per_sec": 0.009523965866588512, "timesteps_total": 6912, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 6912, "timers": {"training_iteration_time_ms": 13237452.746, "sample_time_ms": 13236960.995, "load_time_ms": 0.475, "load_throughput": 269621.792, "learn_time_ms": 490.717, "learn_throughput": 260.843, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6912, "num_env_steps_trained": 6912, "num_agent_steps_sampled": 6912, "num_agent_steps_trained": 6912}, "done": false, "episodes_total": 54, "training_iteration": 54, "trial_id": "default", "date": "2023-11-09_17-50-29", "timestamp": 1699541429, "time_this_iter_s": 13439.780140399933, "time_total_s": 781729.4185655117, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 781729.4185655117, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 7.164150844982266, "ram_util_percent": 45.16479240559149}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33925763169924417, "cur_kl_coeff": 1.1102230246251569e-17, "cur_lr": 4.999999999999999e-05, "total_loss": 9.410656134287516, "policy_loss": -0.002420065909003218, "vf_loss": 9.413075955708821, "vf_explained_var": -0.00018440087636311848, "kl": 0.00023936935995152452, "entropy": 1.9177924076716104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1635.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 7040, "num_env_steps_trained": 7040, "num_agent_steps_sampled": 7040, "num_agent_steps_trained": 7040}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.52107764790766, "episode_len_mean": 127.96363636363637, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4544324360693167, "mean_inference_ms": 2.187070516618127, "mean_action_processing_ms": 0.1673250322035126, "mean_env_wait_ms": 110079.86532398789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.52107764790766, "episode_len_mean": 127.96363636363637, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4544324360693167, "mean_inference_ms": 2.187070516618127, "mean_action_processing_ms": 0.1673250322035126, "mean_env_wait_ms": 110079.86532398789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7040, "num_agent_steps_trained": 7040, "num_env_steps_sampled": 7040, "num_env_steps_trained": 7040, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009785539265471078, "num_env_steps_trained_throughput_per_sec": 0.009785539265471078, "timesteps_total": 7040, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 7040, "timers": {"training_iteration_time_ms": 13415603.146, "sample_time_ms": 13415153.229, "load_time_ms": 0.465, "load_throughput": 275374.904, "learn_time_ms": 448.881, "learn_throughput": 285.154, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7040, "num_env_steps_trained": 7040, "num_agent_steps_sampled": 7040, "num_agent_steps_trained": 7040}, "done": false, "episodes_total": 55, "training_iteration": 55, "trial_id": "default", "date": "2023-11-09_21-28-29", "timestamp": 1699554509, "time_this_iter_s": 13080.527161836624, "time_total_s": 794809.9457273483, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 794809.9457273483, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 7.194812433011789, "ram_util_percent": 45.07854769560557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6282135585943858, "cur_kl_coeff": 5.5511151231257846e-18, "cur_lr": 4.999999999999999e-05, "total_loss": 9.526739724477132, "policy_loss": -0.008431181016688546, "vf_loss": 9.535170936584473, "vf_explained_var": -2.940495808919271e-06, "kl": 0.0009995898456206002, "entropy": 1.914253032207489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.42565513180273, "episode_len_mean": 127.96428571428571, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45446506989017266, "mean_inference_ms": 2.1858495385325436, "mean_action_processing_ms": 0.1672552038981168, "mean_env_wait_ms": 110019.66468282194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.42565513180273, "episode_len_mean": 127.96428571428571, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45446506989017266, "mean_inference_ms": 2.1858495385325436, "mean_action_processing_ms": 0.1672552038981168, "mean_env_wait_ms": 110019.66468282194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009566469057460954, "num_env_steps_trained_throughput_per_sec": 0.009566469057460954, "timesteps_total": 7168, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 13244319.163, "sample_time_ms": 13243868.241, "load_time_ms": 0.467, "load_throughput": 274291.581, "learn_time_ms": 449.879, "learn_throughput": 284.521, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "episodes_total": 56, "training_iteration": 56, "trial_id": "default", "date": "2023-11-10_01-11-30", "timestamp": 1699567890, "time_this_iter_s": 13380.068007469177, "time_total_s": 808190.0137348175, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 808190.0137348175, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 7.5548540891706395, "ram_util_percent": 45.243558442919266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5564516146977743, "cur_kl_coeff": 2.7755575615628923e-18, "cur_lr": 4.999999999999999e-05, "total_loss": 9.202455234527587, "policy_loss": -0.003919149314363797, "vf_loss": 9.206374327341715, "vf_explained_var": -2.284844716389974e-06, "kl": 0.00030477858272206506, "entropy": 1.9055278857549032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1695.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 7296, "num_env_steps_trained": 7296, "num_agent_steps_sampled": 7296, "num_agent_steps_trained": 7296}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.57159675508215, "episode_len_mean": 127.96491228070175, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.454476351687254, "mean_inference_ms": 2.184804853995105, "mean_action_processing_ms": 0.16717942775708766, "mean_env_wait_ms": 109973.31056444808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.57159675508215, "episode_len_mean": 127.96491228070175, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.454476351687254, "mean_inference_ms": 2.184804853995105, "mean_action_processing_ms": 0.16717942775708766, "mean_env_wait_ms": 109973.31056444808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7296, "num_agent_steps_trained": 7296, "num_env_steps_sampled": 7296, "num_env_steps_trained": 7296, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008189877357768775, "num_env_steps_trained_throughput_per_sec": 0.008189877357768775, "timesteps_total": 7296, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 7296, "timers": {"training_iteration_time_ms": 13484854.427, "sample_time_ms": 13484406.232, "load_time_ms": 0.471, "load_throughput": 271475.987, "learn_time_ms": 447.145, "learn_throughput": 286.261, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7296, "num_env_steps_trained": 7296, "num_agent_steps_sampled": 7296, "num_agent_steps_trained": 7296}, "done": false, "episodes_total": 57, "training_iteration": 57, "trial_id": "default", "date": "2023-11-10_05-31-59", "timestamp": 1699583519, "time_this_iter_s": 15629.050423145294, "time_total_s": 823819.0641579628, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 823819.0641579628, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 7.759140653031934, "ram_util_percent": 45.517568173663435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.51659148534139, "cur_kl_coeff": 1.3877787807814461e-18, "cur_lr": 4.999999999999999e-05, "total_loss": 9.54967549641927, "policy_loss": -0.003889712567130725, "vf_loss": 9.553565152486165, "vf_explained_var": -3.417332967122396e-07, "kl": 0.0004255361294023411, "entropy": 1.9037527958552043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1725.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 7424, "num_env_steps_trained": 7424, "num_agent_steps_sampled": 7424, "num_agent_steps_trained": 7424}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.3789835406404, "episode_len_mean": 127.96551724137932, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4544613763610052, "mean_inference_ms": 2.183820638934299, "mean_action_processing_ms": 0.16709874807860417, "mean_env_wait_ms": 109918.73424835436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.3789835406404, "episode_len_mean": 127.96551724137932, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4544613763610052, "mean_inference_ms": 2.183820638934299, "mean_action_processing_ms": 0.16709874807860417, "mean_env_wait_ms": 109918.73424835436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7424, "num_agent_steps_trained": 7424, "num_env_steps_sampled": 7424, "num_env_steps_trained": 7424, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.010482657550828603, "num_env_steps_trained_throughput_per_sec": 0.010482657550828603, "timesteps_total": 7424, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 7424, "timers": {"training_iteration_time_ms": 13326020.074, "sample_time_ms": 13325565.358, "load_time_ms": 0.467, "load_throughput": 274347.648, "learn_time_ms": 453.668, "learn_throughput": 282.145, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7424, "num_env_steps_trained": 7424, "num_agent_steps_sampled": 7424, "num_agent_steps_trained": 7424}, "done": false, "episodes_total": 58, "training_iteration": 58, "trial_id": "default", "date": "2023-11-10_08-55-29", "timestamp": 1699595729, "time_this_iter_s": 12210.64472937584, "time_total_s": 836029.7088873386, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 836029.7088873386, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 7.622715269804821, "ram_util_percent": 45.40945464982779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41206541458765666, "cur_kl_coeff": 6.938893903907231e-19, "cur_lr": 4.999999999999999e-05, "total_loss": 9.435914230346679, "policy_loss": -0.0015543382614850998, "vf_loss": 9.437468560536702, "vf_explained_var": -9.159247080485025e-06, "kl": 0.00030351689468564776, "entropy": 1.8933268706003825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 7552, "num_env_steps_trained": 7552, "num_agent_steps_sampled": 7552, "num_agent_steps_trained": 7552}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.30749972760292, "episode_len_mean": 127.96610169491525, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45443914812155245, "mean_inference_ms": 2.182901761186081, "mean_action_processing_ms": 0.167015117478368, "mean_env_wait_ms": 109864.08027611134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.30749972760292, "episode_len_mean": 127.96610169491525, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45443914812155245, "mean_inference_ms": 2.182901761186081, "mean_action_processing_ms": 0.167015117478368, "mean_env_wait_ms": 109864.08027611134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7552, "num_agent_steps_trained": 7552, "num_env_steps_sampled": 7552, "num_env_steps_trained": 7552, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009653461756904746, "num_env_steps_trained_throughput_per_sec": 0.009653461756904746, "timesteps_total": 7552, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 7552, "timers": {"training_iteration_time_ms": 13393293.289, "sample_time_ms": 13392844.386, "load_time_ms": 0.446, "load_throughput": 286897.297, "learn_time_ms": 447.875, "learn_throughput": 285.794, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7552, "num_env_steps_trained": 7552, "num_agent_steps_sampled": 7552, "num_agent_steps_trained": 7552}, "done": false, "episodes_total": 59, "training_iteration": 59, "trial_id": "default", "date": "2023-11-10_12-36-29", "timestamp": 1699608989, "time_this_iter_s": 13259.492784023285, "time_total_s": 849289.2016713619, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 849289.2016713619, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 6.9499365549328544, "ram_util_percent": 45.49201120862853}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7151402433713278, "cur_kl_coeff": 3.4694469519536153e-19, "cur_lr": 4.999999999999999e-05, "total_loss": 9.56251916885376, "policy_loss": -0.007439931109547615, "vf_loss": 9.569959290822347, "vf_explained_var": -1.9319852193196614e-05, "kl": 0.000539120592444912, "entropy": 1.8980109731356303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1785.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.6164274325397, "episode_len_mean": 127.96666666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45441908842831374, "mean_inference_ms": 2.1821017972231447, "mean_action_processing_ms": 0.16693228526401602, "mean_env_wait_ms": 109828.72074062818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.6164274325397, "episode_len_mean": 127.96666666666667, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45441908842831374, "mean_inference_ms": 2.1821017972231447, "mean_action_processing_ms": 0.16693228526401602, "mean_env_wait_ms": 109828.72074062818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.00739523543641144, "num_env_steps_trained_throughput_per_sec": 0.00739523543641144, "timesteps_total": 7680, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 13682818.992, "sample_time_ms": 13682380.268, "load_time_ms": 0.45, "load_throughput": 284209.059, "learn_time_ms": 437.693, "learn_throughput": 292.442, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 60, "training_iteration": 60, "trial_id": "default", "date": "2023-11-10_17-24-57", "timestamp": 1699626297, "time_this_iter_s": 17308.44334411621, "time_total_s": 866597.6450154781, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 866597.6450154781, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 7.48817787857924, "ram_util_percent": 45.458717751407406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1418500264485676, "cur_kl_coeff": 1.7347234759768077e-19, "cur_lr": 4.999999999999999e-05, "total_loss": 8.906141153971355, "policy_loss": -0.00431749876588583, "vf_loss": 8.910458660125732, "vf_explained_var": 4.186034202575683e-05, "kl": 0.0006080217724350708, "entropy": 1.9012674729029337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1815.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 7808, "num_env_steps_trained": 7808, "num_agent_steps_sampled": 7808, "num_agent_steps_trained": 7808}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.28054116770754, "episode_len_mean": 127.9672131147541, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45439607409554644, "mean_inference_ms": 2.181337669889637, "mean_action_processing_ms": 0.16684403660509287, "mean_env_wait_ms": 109800.82135354365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.28054116770754, "episode_len_mean": 127.9672131147541, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45439607409554644, "mean_inference_ms": 2.181337669889637, "mean_action_processing_ms": 0.16684403660509287, "mean_env_wait_ms": 109800.82135354365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7808, "num_agent_steps_trained": 7808, "num_env_steps_sampled": 7808, "num_env_steps_trained": 7808, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008415093778974796, "num_env_steps_trained_throughput_per_sec": 0.008415093778974796, "timesteps_total": 7808, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 7808, "timers": {"training_iteration_time_ms": 13829796.116, "sample_time_ms": 13829393.22, "load_time_ms": 0.455, "load_throughput": 281098.964, "learn_time_ms": 401.858, "learn_throughput": 318.521, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7808, "num_env_steps_trained": 7808, "num_agent_steps_sampled": 7808, "num_agent_steps_trained": 7808}, "done": false, "episodes_total": 61, "training_iteration": 61, "trial_id": "default", "date": "2023-11-10_21-38-28", "timestamp": 1699641508, "time_this_iter_s": 15210.764017105103, "time_total_s": 881808.4090325832, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 881808.4090325832, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 6.950186644545832, "ram_util_percent": 45.28667680538273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37934249043464663, "cur_kl_coeff": 8.673617379884038e-20, "cur_lr": 4.999999999999999e-05, "total_loss": 9.429457791646321, "policy_loss": -0.004945647995918989, "vf_loss": 9.43440326054891, "vf_explained_var": 1.3428926467895508e-05, "kl": 0.0008445420697171357, "entropy": 1.9075542012850444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1845.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 7936, "num_env_steps_trained": 7936, "num_agent_steps_sampled": 7936, "num_agent_steps_trained": 7936}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.60442884216592, "episode_len_mean": 127.96774193548387, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4543620946587995, "mean_inference_ms": 2.1806496277929015, "mean_action_processing_ms": 0.16675386685054594, "mean_env_wait_ms": 109785.47943063486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.60442884216592, "episode_len_mean": 127.96774193548387, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4543620946587995, "mean_inference_ms": 2.1806496277929015, "mean_action_processing_ms": 0.16675386685054594, "mean_env_wait_ms": 109785.47943063486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7936, "num_agent_steps_trained": 7936, "num_env_steps_sampled": 7936, "num_env_steps_trained": 7936, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.007645818030898265, "num_env_steps_trained_throughput_per_sec": 0.007645818030898265, "timesteps_total": 7936, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 7936, "timers": {"training_iteration_time_ms": 14316112.09, "sample_time_ms": 14315730.633, "load_time_ms": 0.446, "load_throughput": 286958.636, "learn_time_ms": 380.426, "learn_throughput": 336.465, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 7936, "num_env_steps_trained": 7936, "num_agent_steps_sampled": 7936, "num_agent_steps_trained": 7936}, "done": false, "episodes_total": 62, "training_iteration": 62, "trial_id": "default", "date": "2023-11-11_02-17-29", "timestamp": 1699658249, "time_this_iter_s": 16741.178596019745, "time_total_s": 898549.587628603, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 898549.587628603, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 7.026703236882878, "ram_util_percent": 45.41284284577698}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43049252132574717, "cur_kl_coeff": 4.336808689942019e-20, "cur_lr": 4.999999999999999e-05, "total_loss": 9.4124924659729, "policy_loss": -0.0052526846528053285, "vf_loss": 9.417745304107665, "vf_explained_var": -3.3060709635416668e-06, "kl": 0.0008476611739752116, "entropy": 1.9217477401097616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1875.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.7153561325271, "episode_len_mean": 127.96825396825396, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4543121933298773, "mean_inference_ms": 2.17999643626914, "mean_action_processing_ms": 0.16665976580559097, "mean_env_wait_ms": 109769.34111653974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.7153561325271, "episode_len_mean": 127.96825396825396, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4543121933298773, "mean_inference_ms": 2.17999643626914, "mean_action_processing_ms": 0.16665976580559097, "mean_env_wait_ms": 109769.34111653974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009420157518924005, "num_env_steps_trained_throughput_per_sec": 0.009420157518924005, "timesteps_total": 8064, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 14384782.401, "sample_time_ms": 14384390.996, "load_time_ms": 0.432, "load_throughput": 296024.985, "learn_time_ms": 390.406, "learn_throughput": 327.864, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 63, "training_iteration": 63, "trial_id": "default", "date": "2023-11-11_06-03-57", "timestamp": 1699671837, "time_this_iter_s": 13587.883839845657, "time_total_s": 912137.4714684486, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 912137.4714684486, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 7.4703193520094935, "ram_util_percent": 45.465639993809006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42777872681617735, "cur_kl_coeff": 2.1684043449710096e-20, "cur_lr": 4.999999999999999e-05, "total_loss": 9.560191853841145, "policy_loss": -0.006436286106084784, "vf_loss": 9.566628392537435, "vf_explained_var": -1.562039057413737e-05, "kl": 0.0006363831867929548, "entropy": 1.9316720485687255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1905.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.70867659474206, "episode_len_mean": 127.96875, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4542546055252098, "mean_inference_ms": 2.179389932016461, "mean_action_processing_ms": 0.1665632161286344, "mean_env_wait_ms": 109758.3483324227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.70867659474206, "episode_len_mean": 127.96875, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4542546055252098, "mean_inference_ms": 2.179389932016461, "mean_action_processing_ms": 0.1665632161286344, "mean_env_wait_ms": 109758.3483324227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008349464105393457, "num_env_steps_trained_throughput_per_sec": 0.008349464105393457, "timesteps_total": 8192, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 14573836.983, "sample_time_ms": 14573438.278, "load_time_ms": 0.442, "load_throughput": 289433.884, "learn_time_ms": 397.694, "learn_throughput": 321.855, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 64, "training_iteration": 64, "trial_id": "default", "date": "2023-11-11_10-19-28", "timestamp": 1699687168, "time_this_iter_s": 15330.325871944427, "time_total_s": 927467.7973403931, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 927467.7973403931, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 7.148296675659609, "ram_util_percent": 45.30941058118798}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9407325049241384, "cur_kl_coeff": 1.0842021724855048e-20, "cur_lr": 4.999999999999999e-05, "total_loss": 9.26312739054362, "policy_loss": -0.0009806645568460226, "vf_loss": 9.264108085632325, "vf_explained_var": -1.1912981669108073e-05, "kl": 0.00040377115825928435, "entropy": 1.935833783944448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 8320, "num_env_steps_trained": 8320, "num_agent_steps_sampled": 8320, "num_agent_steps_trained": 8320}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.75587468253967, "episode_len_mean": 127.96923076923076, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4541842072716486, "mean_inference_ms": 2.178806621121068, "mean_action_processing_ms": 0.16646480605901764, "mean_env_wait_ms": 109748.13030787147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.75587468253967, "episode_len_mean": 127.96923076923076, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4541842072716486, "mean_inference_ms": 2.178806621121068, "mean_action_processing_ms": 0.16646480605901764, "mean_env_wait_ms": 109748.13030787147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8320, "num_agent_steps_trained": 8320, "num_env_steps_sampled": 8320, "num_env_steps_trained": 8320, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009077114371294742, "num_env_steps_trained_throughput_per_sec": 0.009077114371294742, "timesteps_total": 8320, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 8320, "timers": {"training_iteration_time_ms": 14675924.166, "sample_time_ms": 14675524.615, "load_time_ms": 0.449, "load_throughput": 284781.939, "learn_time_ms": 398.546, "learn_throughput": 321.167, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 8320, "num_env_steps_trained": 8320, "num_agent_steps_sampled": 8320, "num_agent_steps_trained": 8320}, "done": false, "episodes_total": 65, "training_iteration": 65, "trial_id": "default", "date": "2023-11-11_14-14-29", "timestamp": 1699701269, "time_this_iter_s": 14101.398407459259, "time_total_s": 941569.1957478523, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 941569.1957478523, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 7.151220482227193, "ram_util_percent": 45.35338801889137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36695394416650134, "cur_kl_coeff": 5.421010862427524e-21, "cur_lr": 4.999999999999999e-05, "total_loss": 9.552697118123373, "policy_loss": -0.005569931802650293, "vf_loss": 9.558266957600912, "vf_explained_var": 4.864931106567383e-05, "kl": 0.0008144782567796937, "entropy": 1.93863072792689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1965.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 8448, "num_env_steps_trained": 8448, "num_agent_steps_sampled": 8448, "num_agent_steps_trained": 8448}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.94065142496392, "episode_len_mean": 127.96969696969697, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4541049777829078, "mean_inference_ms": 2.178244173973159, "mean_action_processing_ms": 0.16636402857627847, "mean_env_wait_ms": 109737.08466944391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 76.94065142496392, "episode_len_mean": 127.96969696969697, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4541049777829078, "mean_inference_ms": 2.178244173973159, "mean_action_processing_ms": 0.16636402857627847, "mean_env_wait_ms": 109737.08466944391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8448, "num_agent_steps_trained": 8448, "num_env_steps_sampled": 8448, "num_env_steps_trained": 8448, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009355451534099597, "num_env_steps_trained_throughput_per_sec": 0.009355451534099597, "timesteps_total": 8448, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 8448, "timers": {"training_iteration_time_ms": 14706103.666, "sample_time_ms": 14705720.857, "load_time_ms": 0.502, "load_throughput": 254900.253, "learn_time_ms": 381.754, "learn_throughput": 335.294, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 8448, "num_env_steps_trained": 8448, "num_agent_steps_sampled": 8448, "num_agent_steps_trained": 8448}, "done": false, "episodes_total": 66, "training_iteration": 66, "trial_id": "default", "date": "2023-11-11_18-02-31", "timestamp": 1699714951, "time_this_iter_s": 13681.863059520721, "time_total_s": 955251.058807373, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 955251.058807373, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 6.57380232617718, "ram_util_percent": 45.29303683967823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9268330613772073, "cur_kl_coeff": 2.710505431213762e-21, "cur_lr": 4.999999999999999e-05, "total_loss": 9.258933194478352, "policy_loss": -0.002813098890086015, "vf_loss": 9.261746215820313, "vf_explained_var": 2.426306406656901e-05, "kl": 0.0003437065475130415, "entropy": 1.9383223096529643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1995.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 8576, "num_env_steps_trained": 8576, "num_agent_steps_sampled": 8576, "num_agent_steps_trained": 8576}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.23371410151623, "episode_len_mean": 127.97014925373135, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45401787082409706, "mean_inference_ms": 2.17772017616112, "mean_action_processing_ms": 0.1662617176502821, "mean_env_wait_ms": 109747.35870418255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.23371410151623, "episode_len_mean": 127.97014925373135, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45401787082409706, "mean_inference_ms": 2.17772017616112, "mean_action_processing_ms": 0.1662617176502821, "mean_env_wait_ms": 109747.35870418255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8576, "num_agent_steps_trained": 8576, "num_env_steps_sampled": 8576, "num_env_steps_trained": 8576, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.006331373344952863, "num_env_steps_trained_throughput_per_sec": 0.006331373344952863, "timesteps_total": 8576, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 8576, "timers": {"training_iteration_time_ms": 15164876.983, "sample_time_ms": 15164511.345, "load_time_ms": 0.581, "load_throughput": 220363.22, "learn_time_ms": 364.485, "learn_throughput": 351.18, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 8576, "num_env_steps_trained": 8576, "num_agent_steps_sampled": 8576, "num_agent_steps_trained": 8576}, "done": false, "episodes_total": 67, "training_iteration": 67, "trial_id": "default", "date": "2023-11-11_23-39-28", "timestamp": 1699735168, "time_this_iter_s": 20216.783571243286, "time_total_s": 975467.8423786163, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 975467.8423786163, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 6.946097298796769, "ram_util_percent": 45.45153784805298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4525098929802577, "cur_kl_coeff": 1.355252715606881e-21, "cur_lr": 4.999999999999999e-05, "total_loss": 9.524746417999268, "policy_loss": -0.004235630358258883, "vf_loss": 9.528982130686442, "vf_explained_var": 6.482799847920736e-05, "kl": 0.0004756558720752461, "entropy": 1.9336153268814087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.26658254435108, "episode_len_mean": 127.97058823529412, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821, 79.46876821428569], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4539267357796166, "mean_inference_ms": 2.177224343507555, "mean_action_processing_ms": 0.1661580362693575, "mean_env_wait_ms": 109761.67013505838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.26658254435108, "episode_len_mean": 127.97058823529412, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821, 79.46876821428569], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4539267357796166, "mean_inference_ms": 2.177224343507555, "mean_action_processing_ms": 0.1661580362693575, "mean_env_wait_ms": 109761.67013505838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008236420609564914, "num_env_steps_trained_throughput_per_sec": 0.008236420609564914, "timesteps_total": 8704, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 15497885.714, "sample_time_ms": 15497539.892, "load_time_ms": 0.583, "load_throughput": 219597.068, "learn_time_ms": 344.672, "learn_throughput": 371.368, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "done": false, "episodes_total": 68, "training_iteration": 68, "trial_id": "default", "date": "2023-11-12_03-58-29", "timestamp": 1699750709, "time_this_iter_s": 15540.732151269913, "time_total_s": 991008.5745298862, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 991008.5745298862, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 6.775713834633949, "ram_util_percent": 45.57357120303126}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8537199457486471, "cur_kl_coeff": 6.776263578034405e-22, "cur_lr": 4.999999999999999e-05, "total_loss": 9.211566162109374, "policy_loss": -0.008432517293840647, "vf_loss": 9.219998645782471, "vf_explained_var": -3.999074300130208e-05, "kl": 0.0007904597401951226, "entropy": 1.9294011791547139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2055.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 8832, "num_env_steps_trained": 8832, "num_agent_steps_sampled": 8832, "num_agent_steps_trained": 8832}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.08591362031285, "episode_len_mean": 127.97101449275362, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821, 79.46876821428569, 64.80042678571428], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4538296879901059, "mean_inference_ms": 2.1767490270285, "mean_action_processing_ms": 0.1660554811762114, "mean_env_wait_ms": 109777.48536669413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.08591362031285, "episode_len_mean": 127.97101449275362, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821, 79.46876821428569, 64.80042678571428], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4538296879901059, "mean_inference_ms": 2.1767490270285, "mean_action_processing_ms": 0.1660554811762114, "mean_env_wait_ms": 109777.48536669413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8832, "num_agent_steps_trained": 8832, "num_env_steps_sampled": 8832, "num_env_steps_trained": 8832, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008690806049037127, "num_env_steps_trained_throughput_per_sec": 0.008690806049037127, "timesteps_total": 8832, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 8832, "timers": {"training_iteration_time_ms": 15644757.313, "sample_time_ms": 15644413.144, "load_time_ms": 0.618, "load_throughput": 207030.276, "learn_time_ms": 342.764, "learn_throughput": 373.434, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 8832, "num_env_steps_trained": 8832, "num_agent_steps_sampled": 8832, "num_agent_steps_trained": 8832}, "done": false, "episodes_total": 69, "training_iteration": 69, "trial_id": "default", "date": "2023-11-12_08-03-57", "timestamp": 1699765437, "time_this_iter_s": 14728.208802461624, "time_total_s": 1005736.7833323479, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1005736.7833323479, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 6.96033128659146, "ram_util_percent": 45.77352087200724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4886730581521988, "cur_kl_coeff": 3.3881317890172025e-22, "cur_lr": 4.999999999999999e-05, "total_loss": 9.55978775024414, "policy_loss": -0.003674040362238884, "vf_loss": 9.563461621602377, "vf_explained_var": -1.6740957895914714e-05, "kl": 0.0005171010928582594, "entropy": 1.9270029067993164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2085.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 8960, "num_env_steps_trained": 8960, "num_agent_steps_sampled": 8960, "num_agent_steps_trained": 8960}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.1416149047619, "episode_len_mean": 127.97142857142858, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821, 79.46876821428569, 64.80042678571428, 80.98500353174606], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4537261953402388, "mean_inference_ms": 2.1762775701327817, "mean_action_processing_ms": 0.16595334438768247, "mean_env_wait_ms": 109789.83251408504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.1416149047619, "episode_len_mean": 127.97142857142858, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821, 79.46876821428569, 64.80042678571428, 80.98500353174606], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4537261953402388, "mean_inference_ms": 2.1762775701327817, "mean_action_processing_ms": 0.16595334438768247, "mean_env_wait_ms": 109789.83251408504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8960, "num_agent_steps_trained": 8960, "num_env_steps_sampled": 8960, "num_env_steps_trained": 8960, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.009608956872141106, "num_env_steps_trained_throughput_per_sec": 0.009608956872141106, "timesteps_total": 8960, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 8960, "timers": {"training_iteration_time_ms": 15246003.645, "sample_time_ms": 15245665.991, "load_time_ms": 0.618, "load_throughput": 207142.107, "learn_time_ms": 336.248, "learn_throughput": 380.672, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 8960, "num_env_steps_trained": 8960, "num_agent_steps_sampled": 8960, "num_agent_steps_trained": 8960}, "done": false, "episodes_total": 70, "training_iteration": 70, "trial_id": "default", "date": "2023-11-12_11-45-58", "timestamp": 1699778758, "time_this_iter_s": 13320.905541419983, "time_total_s": 1019057.6888737679, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1019057.6888737679, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 7.241909172235963, "ram_util_percent": 45.72078619165395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32800532976786295, "cur_kl_coeff": 1.6940658945086012e-22, "cur_lr": 4.999999999999999e-05, "total_loss": 9.4394255956014, "policy_loss": -0.003921333389977614, "vf_loss": 9.443347040812174, "vf_explained_var": 0.00011668801307678223, "kl": 0.0002641720846440876, "entropy": 1.929811946551005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2115.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 9088, "num_env_steps_trained": 9088, "num_agent_steps_sampled": 9088, "num_agent_steps_trained": 9088}, "sampler_results": {"episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.08771362284818, "episode_len_mean": 127.97183098591549, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821, 79.46876821428569, 64.80042678571428, 80.98500353174606, 73.31462388888886], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45361546958955173, "mean_inference_ms": 2.175820291274965, "mean_action_processing_ms": 0.16585114417791913, "mean_env_wait_ms": 109802.20850322869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": 99.49306119047621, "episode_reward_min": 43.15290964285712, "episode_reward_mean": 77.08771362284818, "episode_len_mean": 127.97183098591549, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.16935166666666, 81.13914650793653, 93.20366138888888, 85.11876293650792, 70.08565261904761, 84.80594503968253, 77.58720484126987, 78.13226190476193, 87.55149503968258, 87.63353996031745, 65.68185138888892, 91.14382734126987, 87.53409476190474, 91.37056488095236, 82.76773623015875, 80.43629515873018, 68.50229932539683, 70.22495698412696, 80.73494686507934, 95.89547087301587, 54.59148539682539, 77.87520753968252, 56.56351948412699, 74.85841476190481, 76.10748277777775, 83.40427095238095, 99.49306119047621, 86.36539853174608, 82.06027821428567, 83.40411353174602, 93.19302571428572, 46.53050146825396, 77.71692027777785, 43.15290964285712, 63.4220431746032, 74.35781119047618, 74.87327107142855, 90.08602706349211, 69.10515765873014, 77.59947944444443, 72.84731424603173, 94.92424678571423, 80.71331265873016, 94.2905594047619, 70.44190436507938, 88.42345809523812, 58.957814484127006, 91.4083631746032, 66.5910736904762, 82.31131996031746, 54.783098571428575, 63.95603055555558, 65.60732801587304, 65.78246841269842, 53.14153341269842, 71.17741674603181, 84.74432765873017, 65.40003031746032, 72.16143857142853, 94.84316202380954, 56.12736527777778, 96.36157698412697, 83.59284813492064, 76.28786571428572, 79.77655230158727, 88.95113968253969, 96.57585075396821, 79.46876821428569, 64.80042678571428, 80.98500353174606, 73.31462388888886], "episode_lengths": [127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 127, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45361546958955173, "mean_inference_ms": 2.175820291274965, "mean_action_processing_ms": 0.16585114417791913, "mean_env_wait_ms": 109802.20850322869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9088, "num_agent_steps_trained": 9088, "num_env_steps_sampled": 9088, "num_env_steps_trained": 9088, "num_env_steps_sampled_this_iter": 128, "num_env_steps_trained_this_iter": 128, "num_env_steps_sampled_throughput_per_sec": 0.008818333737308953, "num_env_steps_trained_throughput_per_sec": 0.008818333737308953, "timesteps_total": 9088, "num_steps_trained_this_iter": 128, "agent_timesteps_total": 9088, "timers": {"training_iteration_time_ms": 15176448.695, "sample_time_ms": 15176112.662, "load_time_ms": 0.622, "load_throughput": 205815.952, "learn_time_ms": 334.613, "learn_throughput": 382.531, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 9088, "num_env_steps_trained": 9088, "num_agent_steps_sampled": 9088, "num_agent_steps_trained": 9088}, "done": false, "episodes_total": 71, "training_iteration": 71, "trial_id": "default", "date": "2023-11-12_15-47-53", "timestamp": 1699793273, "time_this_iter_s": 14515.214637994766, "time_total_s": 1033572.9035117626, "pid": 815386, "hostname": "rancher-rd-bastion", "node_ip": "10.27.41.23", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": null, "env_config": {}, "observation_space": "Dict('cpu': Discrete(9, start=4), 'heap': Discrete(9, start=4), 'instant_tps': Box(0.0, 200.0, (1,), float16), 'previous_tps': Box(0.0, 200.0, (1,), float16), 'replica': Discrete(6, start=1))", "action_space": "Discrete(7)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 128, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x73801e7eed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "<function policy_input at 0x7380e89c79a0>", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 1033572.9035117626, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 6.882174249009949, "ram_util_percent": 45.89220998744326}}
